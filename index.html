<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Zikrov Market OS v15.0 | Premium Enterprise</title>
    
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <style>
        /* ================================================================
           1. CSS –ü–ï–†–ï–ú–ï–ù–ù–´–ï –ò –î–ò–ó–ê–ô–ù-–°–ò–°–¢–ï–ú–ê (SF PRO / INTER)
           ================================================================
        */
        :root {
            --pure-black: #000000;
            --bg-main: #09090b;
            --bg-card: #141417;
            --bg-card-hover: #1c1c21;
            --accent: #3b82f6;
            --accent-glow: rgba(59, 130, 246, 0.5);
            --success: #10b981;
            --error: #ef4444;
            --warning: #f59e0b;
            --text-primary: #f4f4f5;
            --text-secondary: #a1a1aa;
            --text-muted: #52525b;
            --border: rgba(255, 255, 255, 0.06);
            --border-active: rgba(255, 255, 255, 0.15);
            --radius-sm: 8px;
            --radius-md: 14px;
            --radius-lg: 20px;
            --safe-bottom: env(safe-area-inset-bottom);
            --transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* ================================================================
           2. –ì–õ–û–ë–ê–õ–¨–ù–´–ï –°–¢–ò–õ–ò –ò –°–ë–†–û–°
           ================================================================
        */
        * {
            margin: 0; padding: 0; box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            font-family: 'Inter', -apple-system, sans-serif;
        }

        body {
            background-color: var(--bg-main);
            color: var(--text-primary);
            overflow-x: hidden;
            width: 100%;
            min-height: 100vh;
            padding-bottom: calc(100px + var(--safe-bottom));
        }

        .container { padding: 0 20px; width: 100%; max-width: 600px; margin: 0 auto; }
        .hidden { display: none !important; }

        /* –ö–∞—Å—Ç–æ–º–Ω—ã–π —Å–∫—Ä–æ–ª–ª */
        ::-webkit-scrollbar { width: 0; }

        /* ================================================================
           3. –ê–ù–ò–ú–ê–¶–ò–ò
           ================================================================
        */
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes slideUp { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        @keyframes scaleIn { from { transform: scale(0.95); opacity: 0; } to { transform: scale(1); opacity: 1; } }
        @keyframes pulse { 0% { opacity: 1; } 50% { opacity: 0.5; } 100% { opacity: 1; } }
        @keyframes shimmer { 0% { background-position: -200% 0; } 100% { background-position: 200% 0; } }

        .anim-fade { animation: fadeIn 0.3s ease-out; }
        .anim-slide { animation: slideUp 0.4s cubic-bezier(0.2, 0.8, 0.2, 1); }

        /* ================================================================
           4. –¢–ò–ü–û–ì–†–ê–§–ò–ö–ê –ò –®–ê–ü–ö–ê
           ================================================================
        */
        .header { padding: 40px 20px 20px; position: sticky; top: 0; background: var(--bg-main); z-index: 100; }
        .header h1 { font-size: 34px; font-weight: 800; letter-spacing: -1.5px; }
        .header p { color: var(--text-secondary); font-size: 14px; margin-top: 5px; }

        .section-title { font-size: 18px; font-weight: 700; margin-bottom: 15px; display: flex; align-items: center; gap: 8px; }

        /* ================================================================
           5. –ö–ê–†–¢–û–ß–ö–ò –ò –ì–†–ò–î–´
           ================================================================
        */
        .grid-categories { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 30px; }
        
        .cat-card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: var(--radius-lg);
            padding: 24px 16px;
            text-align: center;
            transition: var(--transition);
            position: relative;
            overflow: hidden;
        }

        .cat-card:active { transform: scale(0.96); background: var(--bg-card-hover); border-color: var(--accent); }
        .cat-card .icon { font-size: 44px; display: block; margin-bottom: 12px; }
        .cat-card .name { font-weight: 700; font-size: 16px; display: block; }
        
        /* –ü—Ä–æ–¥—É–∫—Ç–æ–≤—ã–µ –∫–∞—Ä—Ç–æ—á–∫–∏ */
        .product-card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: var(--radius-md);
            padding: 16px;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            transition: var(--transition);
        }

        .product-card:active { border-color: var(--accent); background: var(--bg-card-hover); }
        
        .prod-info h3 { font-size: 16px; font-weight: 700; margin-bottom: 4px; }
        .prod-tags { display: flex; gap: 6px; }
        .tag { font-size: 10px; background: rgba(255,255,255,0.05); padding: 2px 8px; border-radius: 4px; color: var(--text-secondary); text-transform: uppercase; }

        .prod-price-box { text-align: right; }
        .price { font-size: 18px; font-weight: 800; color: var(--accent); }
        .stock { font-size: 11px; color: var(--success); font-weight: 600; margin-top: 2px; }

        /* ================================================================
           6. –ö–ù–û–ü–ö–ò –ò –í–í–û–î
           ================================================================
        */
        .btn {
            width: 100%; border: none; border-radius: var(--radius-md);
            padding: 18px; font-weight: 700; font-size: 16px;
            display: flex; align-items: center; justify-content: center; gap: 10px;
            cursor: pointer; transition: var(--transition);
        }

        .btn-primary { background: var(--accent); color: white; box-shadow: 0 4px 15px var(--accent-glow); }
        .btn-secondary { background: var(--bg-card-hover); color: white; border: 1px solid var(--border); }
        .btn-ghost { background: transparent; color: var(--text-secondary); border: 1px solid transparent; }
        .btn-success { background: var(--success); color: white; }
        .btn-error { background: var(--error); color: white; }

        .btn:active { transform: scale(0.98); opacity: 0.9; }

        .input-group { margin-bottom: 18px; }
        .input-group label { display: block; font-size: 12px; font-weight: 600; color: var(--text-secondary); margin-bottom: 6px; margin-left: 4px; }
        .input-group input, .input-group select, .input-group textarea {
            width: 100%; background: #1a1a1e; border: 1px solid var(--border);
            border-radius: var(--radius-md); padding: 14px 16px; color: white;
            font-size: 15px; transition: var(--transition); outline: none;
        }
        .input-group input:focus { border-color: var(--accent); background: #222226; }

        /* ================================================================
           7. –¢–ê–ë-–ë–ê–† (NAVIGATION)
           ================================================================
        */
        .nav-bar {
            position: fixed; bottom: 0; left: 0; right: 0;
            height: calc(85px + var(--safe-bottom));
            background: rgba(14, 14, 17, 0.85);
            backdrop-filter: blur(25px); -webkit-backdrop-filter: blur(25px);
            border-top: 1px solid var(--border);
            display: flex; justify-content: space-around;
            padding: 10px 10px var(--safe-bottom);
            z-index: 1000;
        }

        .nav-item {
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            color: var(--text-secondary); text-decoration: none; width: 20%;
            transition: var(--transition); position: relative;
        }

        .nav-item.active { color: var(--accent); }
        .nav-item svg { width: 24px; height: 24px; margin-bottom: 5px; fill: currentColor; }
        .nav-item span { font-size: 10px; font-weight: 700; text-transform: uppercase; letter-spacing: 0.5px; }

        /* ================================================================
           8. –ú–û–î–ê–õ–¨–ù–´–ï –û–ö–ù–ê (ULTIMATE MODALS)
           ================================================================
        */
        .modal-overlay {
            position: fixed; top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.9); display: none; align-items: flex-end;
            z-index: 2000; backdrop-filter: blur(15px);
        }

        .modal-overlay.active { display: flex; }

        .modal-sheet {
            background: var(--bg-card); width: 100%; border-radius: 30px 30px 0 0;
            padding: 35px 24px calc(40px + var(--safe-bottom));
            transform: translateY(100%); transition: transform 0.4s cubic-bezier(0.2, 0.8, 0.2, 1);
            max-height: 95vh; overflow-y: auto; border-top: 1px solid var(--border-active);
        }

        .modal-overlay.active .modal-sheet { transform: translateY(0); }

        /* –ó–∞–≥—Ä—É–∑–∫–∞ —Å–∫—Ä–∏–Ω—à–æ—Ç–∞ */
        .screenshot-box {
            border: 2px dashed var(--border); border-radius: var(--radius-md);
            padding: 40px 20px; text-align: center; margin: 20px 0;
            position: relative; transition: var(--transition);
        }
        .screenshot-box.has-file { border-color: var(--success); background: rgba(16, 185, 129, 0.05); }
        .screenshot-box input { position: absolute; top: 0; left: 0; width: 100%; height: 100%; opacity: 0; cursor: pointer; }
        #preview-img { width: 100%; border-radius: 12px; margin-top: 15px; display: none; border: 1px solid var(--border); }

        /* ================================================================
           9. –°–ü–ï–¶–ò–§–ò–ß–ï–°–ö–ò–ï –≠–õ–ï–ú–ï–ù–¢–´ (ADMIN & TERMINAL)
           ================================================================
        */
        .admin-log-console {
            background: #000; border-radius: 12px; padding: 15px;
            font-family: 'Courier New', monospace; font-size: 11px; color: #00ff00;
            height: 180px; overflow-y: auto; border: 1px solid #333; margin: 15px 0;
            line-height: 1.6;
        }

        .history-item {
            background: rgba(255,255,255,0.02); border-radius: 12px;
            padding: 15px; margin-bottom: 10px; border: 1px solid var(--border);
        }

        .loader-ring {
            width: 40px; height: 40px; border: 3px solid rgba(255,255,255,0.1);
            border-radius: 50%; border-top-color: var(--accent);
            animation: spin 1s linear infinite; margin: 20px auto;
        }
        @keyframes spin { to { transform: rotate(360deg); } }

    </style>
</head>
<body>

    <div id="view-market" class="view anim-fade">
        <div class="header">
            <h1>Zikrov Market</h1>
            <p>Enterprise Account Gateway</p>
        </div>
        
        <div class="container">
            <div id="category-grid" class="grid-categories">
                </div>

            <div id="product-list-view" class="hidden">
                <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 20px;">
                    <h2 id="cat-view-title" class="section-title">–¢–æ–≤–∞—Ä—ã</h2>
                    <button class="btn-ghost" style="width: auto; padding: 5px 12px; font-size: 13px;" onclick="Router.backToCats()">‚Üê –ù–∞–∑–∞–¥</button>
                </div>
                <div id="products-render-container"></div>
            </div>
        </div>
    </div>

    <div id="view-profile" class="view hidden anim-fade">
        <div class="header">
            <h1>–ö–∞–±–∏–Ω–µ—Ç</h1>
            <p>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏ –∏—Å—Ç–æ—Ä–∏—è</p>
        </div>
        <div class="container">
            <div class="cat-card" style="width: 100%; text-align: left; display: flex; gap: 20px; align-items: center; margin-bottom: 20px;">
                <div id="u-ava" style="width: 70px; height: 70px; border-radius: 24px; background: var(--accent); display: flex; align-items: center; justify-content: center; font-size: 30px; font-weight: 800; color: white;">?</div>
                <div>
                    <h2 id="u-name">User</h2>
                    <p style="color: var(--text-secondary); font-size: 13px;">ID: <span id="u-id">000000</span></p>
                    <div style="margin-top: 8px;" id="u-badge"><span class="tag" style="background: var(--accent); color: white;">Premium User</span></div>
                </div>
            </div>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 25px;">
                <div class="cat-card" style="padding: 15px;">
                    <span style="color: var(--text-secondary); font-size: 11px; display: block; margin-bottom: 5px;">–ü–û–ö–£–ü–û–ö</span>
                    <span id="stat-orders" style="font-size: 22px; font-weight: 800;">0</span>
                </div>
                <div class="cat-card" style="padding: 15px;">
                    <span style="color: var(--text-secondary); font-size: 11px; display: block; margin-bottom: 5px;">–¢–†–ê–¢–´</span>
                    <span id="stat-spent" style="font-size: 22px; font-weight: 800; color: var(--accent);">0 ‚ÇΩ</span>
                </div>
            </div>

            <button class="btn btn-secondary" style="margin-bottom: 12px;" onclick="Router.openHistory()">üìë –ú–û–ò –ü–û–ö–£–ü–ö–ò</button>
            <button class="btn btn-secondary" style="margin-bottom: 30px;" onclick="TG.openTelegramLink('https://t.me/Z1KROV')">üÜò –ü–û–î–î–ï–†–ñ–ö–ê</button>

            <div id="admin-access-block" class="hidden">
                <h3 class="section-title" style="color: var(--error);">SYSTEM OVERRIDE</h3>
                <button class="btn btn-primary" style="background: var(--error); box-shadow: 0 4px 15px rgba(239, 68, 68, 0.3);" onclick="Router.go('admin')">–ü–ê–ù–ï–õ–¨ –£–ü–†–ê–í–õ–ï–ù–ò–Ø v15.0</button>
            </div>
        </div>
    </div>

    <div id="view-admin" class="view hidden anim-fade">
        <div class="header">
            <h1 style="color: var(--error);">Admin Panel</h1>
            <p>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞–º–∏ –∏ API Lolz</p>
        </div>
        <div class="container">
            <div style="margin-bottom: 20px;">
                <button class="btn-ghost" onclick="Router.go('profile')">‚Üê –ù–∞–∑–∞–¥ –≤ –ø—Ä–æ—Ñ–∏–ª—å</button>
            </div>

            <div class="cat-card" style="width: 100%; text-align: left; margin-bottom: 20px; border-color: var(--error);">
                <h3 class="section-title">Settings</h3>
                <div class="input-group">
                    <label>LOLZ API TOKEN</label>
                    <input type="password" id="cfg-lolz-token" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à —Ç–æ–∫–µ–Ω...">
                </div>
                <div class="input-group">
                    <label>ID –ê–î–ú–ò–ù-–ß–ê–¢–ê (–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è)</label>
                    <input type="text" id="cfg-admin-chat" placeholder="–ù–∞–ø—Ä: 12345678">
                </div>
                <button class="btn btn-primary" style="padding: 12px; font-size: 14px;" onclick="Admin.saveConfig()">–û–ë–ù–û–í–ò–¢–¨ –ö–û–ù–§–ò–ì</button>
            </div>

            <div class="cat-card" style="width: 100%; text-align: left; margin-bottom: 20px;">
                <h3 class="section-title">New Product</h3>
                <div class="input-group">
                    <label>–ù–∞–∑–≤–∞–Ω–∏–µ –≤ –º–∞–≥–∞–∑–∏–Ω–µ</label>
                    <input type="text" id="adm-p-name" placeholder="–ù–∞–ø—Ä: TG –ê–≤—Ç–æ—Ä–µ–≥ (RU)">
                </div>
                <div class="input-group">
                    <label>–ù–∞—Ü–µ–Ω–∫–∞ (%)</label>
                    <input type="number" id="adm-p-margin" placeholder="20">
                </div>
                
                <hr style="border: none; border-top: 1px solid var(--border); margin: 15px 0;">
                <p style="font-size: 11px; color: var(--accent); margin-bottom: 10px; font-weight: 700;">–ü–ê–†–ê–ú–ï–¢–†–´ –ü–ê–†–°–ò–ù–ì–ê LOLZ</p>
                
                <div class="input-group">
                    <label>–ö–∞—Ç–µ–≥–æ—Ä–∏—è Lolz (ID)</label>
                    <select id="adm-lz-cat">
                        <option value="2">Telegram</option>
                        <option value="1">Steam</option>
                        <option value="4">Epic Games</option>
                        <option value="11">Discord</option>
                        <option value="14">VPN</option>
                    </select>
                </div>

                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                    <div class="input-group">
                        <label>–ú–∏–Ω. —Ü–µ–Ω–∞</label>
                        <input type="number" id="adm-lz-min" placeholder="10">
                    </div>
                    <div class="input-group">
                        <label>–ú–∞–∫—Å. —Ü–µ–Ω–∞</label>
                        <input type="number" id="adm-lz-max" placeholder="500">
                    </div>
                </div>

                <div class="input-group">
                    <label>–ü—Ä–æ–∏—Å—Ö–æ–∂–¥–µ–Ω–∏–µ (Origin)</label>
                    <select id="adm-lz-origin">
                        <option value="autoreg">–ê–≤—Ç–æ—Ä–µ–≥</option>
                        <option value="brute">–ë—Ä—É—Ç</option>
                        <option value="owner">–õ–∏—á–Ω—ã–π</option>
                        <option value="resale">–ü–µ—Ä–µ–ø—Ä–æ–¥–∞–∂–∞</option>
                    </select>
                </div>

                <div class="input-group">
                    <label>–ö–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ –≤ –Ω–∞–∑–≤–∞–Ω–∏–∏</label>
                    <input type="text" id="adm-lz-query" placeholder="–ù–∞–ø—Ä: 100+ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤">
                </div>

                <button class="btn btn-success" onclick="Admin.addProduct()">–î–û–ë–ê–í–ò–¢–¨ –í –ú–ê–†–ö–ï–¢</button>
            </div>

            <h3 class="section-title">Console Output</h3>
            <div class="admin-log-console" id="admin-log">
                > System kernel v15.0 initialized...
                <br>> Ready for operations.
            </div>
            
            <button class="btn btn-error" style="background: #222;" onclick="Admin.clearData()">–°–ë–†–û–°–ò–¢–¨ –í–°–ï –î–ê–ù–ù–´–ï</button>
        </div>
    </div>

    <div id="modal-pay" class="modal-overlay">
        <div class="modal-sheet">
            <h2 id="m-pay-title" style="font-size: 24px; font-weight: 800; margin-bottom: 8px;">–û–ø–ª–∞—Ç–∞</h2>
            <p id="m-pay-subtitle" style="color: var(--text-secondary); font-size: 14px; margin-bottom: 25px;">–ü–µ—Ä–µ–≤–µ–¥–∏—Ç–µ —Å—Ä–µ–¥—Å—Ç–≤–∞ –∏ –ø—Ä–∏–∫—Ä–µ–ø–∏—Ç–µ —á–µ–∫</p>
            
            <div class="cat-card" style="width: 100%; background: #1a1a1e; border-color: var(--accent); margin-bottom: 20px;">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <span style="color: var(--text-secondary); font-size: 13px;">–°—É–º–º–∞ –∫ –æ–ø–ª–∞—Ç–µ:</span>
                    <span id="m-pay-price" style="font-size: 24px; font-weight: 800; color: var(--accent);">0 ‚ÇΩ</span>
                </div>
                <hr style="border: none; border-top: 1px solid #333; margin: 15px 0;">
                <p style="font-size: 12px; color: var(--text-secondary); margin-bottom: 5px;">–†–µ–∫–≤–∏–∑–∏—Ç—ã (–ö–∞—Ä—Ç–∞/–°–ë–ü):</p>
                <div style="display: flex; gap: 10px; align-items: center;">
                    <code id="m-pay-wallet" style="font-size: 18px; font-weight: 700; color: white;">4400 1122 3344 5566</code>
                    <button class="btn-ghost" style="width: auto; padding: 5px;" onclick="TG.copyToClipboard('4400112233445566'); TG.showAlert('–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!')">üìã</button>
                </div>
            </div>

            <div class="screenshot-box" id="sc-box">
                <span id="sc-label">–ù–∞–∂–º–∏—Ç–µ –¥–ª—è –≤—ã–±–æ—Ä–∞ —Å–∫—Ä–∏–Ω—à–æ—Ç–∞ —á–µ–∫–∞</span>
                <input type="file" id="pay-file-input" accept="image/*">
                <img id="preview-img" src="">
            </div>

            <div id="pay-flow-actions">
                <button class="btn btn-primary" id="btn-submit-pay" onclick="Payment.submit()">–û–¢–ü–†–ê–í–ò–¢–¨ –ù–ê –ü–†–û–í–ï–†–ö–£</button>
                <button class="btn btn-ghost" style="margin-top: 10px;" onclick="Router.closeModal()">–û—Ç–º–µ–Ω–∞</button>
            </div>

            <div id="pay-flow-loading" class="hidden" style="text-align: center;">
                <div class="loader-ring"></div>
                <p style="color: var(--accent); font-weight: 600;">–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–ª–∞—Ç–µ–∂–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º...</p>
                <p style="font-size: 12px; color: var(--text-secondary); margin-top: 10px;">–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –Ω–µ –∑–∞–∫—Ä—ã–≤–∞–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ.</p>
            </div>
        </div>
    </div>

    <nav class="nav-bar">
        <a href="javascript:void(0)" class="nav-item active" onclick="Router.go('market')">
            <svg viewBox="0 0 24 24"><path d="M12 3L4 9v12h16V9l-8-6zm6 16h-3v-4h-6v4H6v-9l6-4.5 6 4.5v9z"/></svg>
            <span>–ú–ê–†–ö–ï–¢</span>
        </a>
        <a href="javascript:void(0)" class="nav-item" onclick="Router.go('profile')">
            <svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 3c1.66 0 3 1.34 3 3s-1.34 3-3 3-3-1.34-3-3 1.34-3 3-3zm0 14.2c-2.5 0-4.71-1.28-6-3.22.03-1.99 4-3.08 6-3.08 1.99 0 5.97 1.09 6 3.08-1.29 1.94-3.5 3.22-6 3.22z"/></svg>
            <span>–ü–†–û–§–ò–õ–¨</span>
        </a>
    </nav>

    <script>
        const TG = window.Telegram.WebApp;
        
        /**
         * –ì–õ–û–ë–ê–õ–¨–ù–û–ï –•–†–ê–ù–ò–õ–ò–©–ï (STORE)
         */
        const App = {
            Config: JSON.parse(localStorage.getItem('zk_config')) || {
                admin_id: 1577146268, // –¢–í–û–ô ID
                lolz_token: 'eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzUxMiJ9.eyJzdWIiOjU3NzQxOTcsImlzcyI6Imx6dCIsImlhdCI6MTc2NjE1MjI0OSwianRpIjoiODk4NTQ5Iiwic2NvcGUiOiJiYXNpYyByZWFkIHBvc3QgY29udmVyc2F0ZSBwYXltZW50IGludm9pY2UgY2hhdGJveCBtYXJrZXQiLCJleHAiOjE5MjM4MzIyNDl9.V6ZEAK9Fum1k6K-cKbMURcJ3jcy3cC6CTVG93hVCTsevCoj4RLkn8Qy0AYR2Q3jDq8t1fWcHuZUsgbSkrlYjBmakLKP-vdFHgMYKqguM9Cgq0qoqS29NFlQiUeA-6AvPI60UgbW4C8hIg1JRXxQzldKz4qYrTBY48CLA_gytt9w',
                admin_chat_id: '',
                wallet: '1577146268'
            },
            
            DB: {
                categories: [
                    { id: 'cat_tg', name: 'Telegram', icon: 'üì±', lz_id: 2 }
                ],
                products: JSON.parse(localStorage.getItem('zk_products')) || [],
                orders: JSON.parse(localStorage.getItem('zk_orders')) || []
            },

            State: {
                user: TG.initDataUnsafe.user || { id: 0, first_name: 'Debug', last_name: 'User' },
                activeCategory: null,
                selectedProduct: null
            }
        };

        /**
         * LOLZ API BRIDGE (–í–ó–ê–ò–ú–û–î–ï–ô–°–¢–í–ò–ï –° –ú–ê–†–ö–ï–¢–û–ú)
         */
        const LolzAPI = {
            baseUrl: 'https://api.lzt.market',

            // –ü–æ–∏—Å–∫ —Å–∞–º–æ–≥–æ –¥–µ—à–µ–≤–æ–≥–æ —Ç–æ–≤–∞—Ä–∞ –ø–æ —Ñ–∏–ª—å—Ç—Ä–∞–º
            async findCheapest(params) {
                if(!App.Config.lolz_token) return { error: 'API Token missing' };

                Admin.log(`Searching Lolz for CatID: ${params.catId}...`);
                
                // –≠–º—É–ª—è—Ü–∏—è –∑–∞–ø—Ä–æ—Å–∞ (–í —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏ –∑–¥–µ—Å—å fetch –∫ /list)
                // –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: category_id, pmin, pmax, origin, title
                const query = `category_id=${params.catId}&pmin=${params.min}&pmax=${params.max}&origin=${params.origin}&title=${params.query}`;
                
                return new Promise((resolve) => {
                    setTimeout(() => {
                        resolve({
                            item_id: Math.floor(Math.random() * 90000000),
                            price: Number(params.min) + 5, // –ë–µ—Ä–µ–º —á—É—Ç—å –≤—ã—à–µ –º–∏–Ω–∏–º–∞–ª–∫–∏
                            title: "Telegram Account | Autoreg | 2FA"
                        });
                    }, 1500);
                });
            },

            // –ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –ø–æ–∫—É–ø–∫–∞
            async purchase(itemId) {
                Admin.log(`Initiating purchase for Item #${itemId}...`);
                // 1. POST /reserve
                // 2. POST /confirm-buy
                return new Promise(resolve => {
                    setTimeout(() => {
                        resolve({
                            success: true,
                            data: "LOG:PASS:2FA_CODE_" + Math.random().toString(36).substr(2, 6).toUpperCase()
                        });
                    }, 2000);
                });
            }
        };

        /**
         * –ò–ù–¢–ï–†–§–ï–ô–° –ò –†–û–£–¢–ò–ù–ì
         */
        const Router = {
            go(view) {
                document.querySelectorAll('.view').forEach(v => v.classList.add('hidden'));
                document.getElementById(`view-${view}`).classList.remove('hidden');
                
                document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
                const navMap = { 'market': 0, 'profile': 1 };
                if(navMap[view] !== undefined) {
                    document.querySelectorAll('.nav-item')[navMap[view]].classList.add('active');
                }
                
                TG.HapticFeedback.selectionChanged();
                window.scrollTo(0,0);
            },

            backToCats() {
                document.getElementById('category-grid').classList.remove('hidden');
                document.getElementById('product-list-view').classList.add('hidden');
                window.scrollTo(0,0);
            },

            openHistory() {
                if(App.DB.orders.length === 0) {
                    TG.showAlert("–£ –≤–∞—Å –µ—â–µ –Ω–µ—Ç –ø–æ–∫—É–ø–æ–∫.");
                    return;
                }
                let list = App.DB.orders.map(o => `üì¶ ${o.name}\nüí∞ ${o.price}‚ÇΩ | ${o.date}\nüîë –î–∞–Ω–Ω—ã–µ: ${o.creds}`).join('\n\n---\n\n');
                TG.showAlert("–í–ê–®–ò –ó–ê–ö–ê–ó–´:\n\n" + list);
            },

            closeModal() {
                document.getElementById('modal-pay').classList.remove('active');
            }
        };

        /**
         * –õ–û–ì–ò–ö–ê –û–ü–õ–ê–¢–´ –ò –ü–û–î–¢–í–ï–†–ñ–î–ï–ù–ò–Ø
         */
        const Payment = {
            init(prodId) {
                const prod = App.DB.products.find(p => p.id === prodId);
                App.State.selectedProduct = prod;

                document.getElementById('m-pay-title').innerText = prod.name;
                document.getElementById('m-pay-price').innerText = prod.price + " ‚ÇΩ";
                document.getElementById('m-pay-wallet').innerText = App.Config.wallet;
                
                // Reset form
                document.getElementById('preview-img').style.display = 'none';
                document.getElementById('sc-label').style.display = 'block';
                document.getElementById('pay-flow-actions').classList.remove('hidden');
                document.getElementById('pay-flow-loading').classList.add('hidden');
                
                document.getElementById('modal-pay').classList.add('active');
                TG.HapticFeedback.impactOccurred('medium');
            },

            submit() {
                const file = document.getElementById('pay-file-input').files[0];
                if(!file) {
                    TG.showAlert("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø—Ä–∏–∫—Ä–µ–ø–∏—Ç–µ —Å–∫—Ä–∏–Ω—à–æ—Ç —á–µ–∫–∞!");
                    return;
                }

                document.getElementById('pay-flow-actions').classList.add('hidden');
                document.getElementById('pay-flow-loading').classList.remove('hidden');

                // –ó–¥–µ—Å—å –º—ã –∏–º–∏—Ç–∏—Ä—É–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∞–¥–º–∏–Ω—É.
                // –í —Ä–µ–∞–ª—å–Ω–æ–º –±–æ—Ç–µ –º—ã –±—ã –æ—Ç–ø—Ä–∞–≤–∏–ª–∏ —Ñ–∞–π–ª —á–µ—Ä–µ–∑ Bot API –∞–¥–º–∏–Ω—É.
                Admin.log(`New payment notification for ${App.State.selectedProduct.name} from UID ${App.State.user.id}`);
                
                // –≠–º—É–ª—è—Ü–∏—è —Ç–æ–≥–æ, —á—Ç–æ –∞–¥–º–∏–Ω –Ω–∞–∂–∞–ª "–ü—Ä–∏–Ω—è—Ç—å" —á–µ—Ä–µ–∑ 4 —Å–µ–∫—É–Ω–¥—ã
                setTimeout(() => {
                    this.confirmAndBuy();
                }, 4000);
            },

            async confirmAndBuy() {
                const p = App.State.selectedProduct;
                Admin.log(`Payment CONFIRMED. Accessing Lolz Market...`);
                
                // 1. –ò—â–µ–º —Ç–æ–≤–∞—Ä –Ω–∞ –ª–æ–ª–∑–µ
                const lzItem = await LolzAPI.findCheapest({
                    catId: p.lz_cat,
                    min: p.lz_min,
                    max: p.lz_max,
                    origin: p.lz_origin,
                    query: p.lz_query
                });

                if(lzItem.error) {
                    TG.showAlert("–û—à–∏–±–∫–∞ API Lolz. –°–≤—è–∂–∏—Ç–µ—Å—å —Å –∞–¥–º–∏–Ω–æ–º.");
                    Router.closeModal();
                    return;
                }

                // 2. –ü–æ–∫—É–ø–∞–µ–º
                const purchaseResult = await LolzAPI.purchase(lzItem.item_id);

                if(purchaseResult.success) {
                    this.finalize(purchaseResult.data);
                }
            },

            finalize(creds) {
                const order = {
                    id: Date.now(),
                    name: App.State.selectedProduct.name,
                    price: App.State.selectedProduct.price,
                    date: new Date().toLocaleString(),
                    creds: creds
                };

                App.DB.orders.unshift(order);
                localStorage.setItem('zk_orders', JSON.stringify(App.DB.orders));
                
                TG.HapticFeedback.notificationOccurred('success');
                Router.closeModal();
                UI.updateStats();

                TG.showConfirm(`–û–ø–ª–∞—Ç–∞ –ø—Ä–∏–Ω—è—Ç–∞! –¢–æ–≤–∞—Ä –∫—É–ø–ª–µ–Ω –Ω–∞ Lolz.\n\n–î–∞–Ω–Ω—ã–µ:\n${creds}\n\n–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å?`, (ok) => {
                    if(ok) {
                        const el = document.createElement('textarea');
                        el.value = creds;
                        document.body.appendChild(el);
                        el.select();
                        document.execCommand('copy');
                        document.body.removeChild(el);
                        TG.showAlert("–î–∞–Ω–Ω—ã–µ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω—ã!");
                    }
                    Router.go('profile');
                });
            }
        };

        /**
         * –ê–î–ú–ò–ù-–î–í–ò–ñ–û–ö
         */
        const Admin = {
            log(msg) {
                const console = document.getElementById('admin-log');
                const time = new Date().toLocaleTimeString();
                console.innerHTML += `<br>> [${time}] ${msg}`;
                console.scrollTop = console.scrollHeight;
            },

            saveConfig() {
                App.Config.lolz_token = document.getElementById('cfg-lolz-token').value;
                App.Config.admin_chat_id = document.getElementById('cfg-admin-chat').value;
                localStorage.setItem('zk_config', JSON.stringify(App.Config));
                TG.showAlert("–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞!");
                this.log("Config updated.");
            },

            addProduct() {
                const name = document.getElementById('adm-p-name').value;
                const margin = Number(document.getElementById('adm-p-margin').value) || 0;
                const cat = document.getElementById('adm-lz-cat').value;
                const min = Number(document.getElementById('adm-lz-min').value);
                const max = Number(document.getElementById('adm-lz-max').value);
                const origin = document.getElementById('adm-lz-origin').value;
                const query = document.getElementById('adm-lz-query').value;

                if(!name || !min || !max) {
                    TG.showAlert("–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è!");
                    return;
                }

                // –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –∏—Ç–æ–≥–æ–≤—É—é —Ü–µ–Ω—É –¥–ª—è –≤–∏—Ç—Ä–∏–Ω—ã
                const finalPrice = Math.ceil(max + (max * (margin / 100)));

                const newProd = {
                    id: Date.now(),
                    name, price: finalPrice, margin,
                    lz_cat: cat, lz_min: min, lz_max: max, lz_origin: origin, lz_query: query
                };

                App.DB.products.push(newProd);
                localStorage.setItem('zk_products', JSON.stringify(App.DB.products));
                
                this.log(`Added product: ${name} (Est. Price: ${finalPrice}‚ÇΩ)`);
                TG.showAlert("–¢–æ–≤–∞—Ä –¥–æ–±–∞–≤–ª–µ–Ω –≤ –º–∞–≥–∞–∑–∏–Ω!");
                UI.renderMarket();
            },

            clearData() {
                TG.showConfirm("–í–´ –£–í–ï–†–ï–ù–´? –í—Å–µ —Ç–æ–≤–∞—Ä—ã –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±—É–¥—É—Ç —Å—Ç–µ—Ä—Ç—ã!", (ok) => {
                    if(ok) {
                        localStorage.clear();
                        location.reload();
                    }
                });
            }
        };

        /**
         * –û–ü–ï–†–ê–¶–ò–û–ù–ù–´–ô –¶–ï–ù–¢–† UI
         */
        const UI = {
            init() {
                TG.ready();
                TG.expand();
                
                this.renderMarket();
                this.updateStats();
                
                // –ü—Ä–∏–≤—è–∑–∫–∞ —Å–æ–±—ã—Ç–∏–π
                document.getElementById('pay-file-input').onchange = (e) => {
                    const reader = new FileReader();
                    reader.onload = (ev) => {
                        const img = document.getElementById('preview-img');
                        img.src = ev.target.result;
                        img.style.display = 'block';
                        document.getElementById('sc-label').style.display = 'none';
                        document.getElementById('sc-box').classList.add('has-file');
                    };
                    reader.readAsDataURL(e.target.files[0]);
                };

                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–¥–º–∏–Ω–∞
                if(App.State.user.id === App.Config.admin_id) {
                    document.getElementById('admin-access-block').classList.remove('hidden');
                }

                document.getElementById('u-name').innerText = App.State.user.first_name + " " + (App.State.user.last_name || "");
                document.getElementById('u-id').innerText = App.State.user.id;
                document.getElementById('u-ava').innerText = App.State.user.first_name[0];

                // –ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥–∞ –≤ –∏–Ω–ø—É—Ç—ã
                document.getElementById('cfg-lolz-token').value = App.Config.lolz_token;
                document.getElementById('cfg-admin-chat').value = App.Config.admin_chat_id;
            },

            renderMarket() {
                const catGrid = document.getElementById('category-grid');
                catGrid.innerHTML = App.DB.categories.map(c => `
                    <div class="cat-card anim-slide" onclick="UI.openCategory('${c.id}')">
                        <span class="icon">${c.icon}</span>
                        <span class="name">${c.name}</span>
                    </div>
                `).join('');
            },

            openCategory(catId) {
                const cat = App.DB.categories.find(c => c.id === catId);
                const products = App.DB.products.filter(p => p.lz_cat == cat.lz_id);
                
                document.getElementById('cat-view-title').innerText = cat.name;
                document.getElementById('category-grid').classList.add('hidden');
                document.getElementById('product-list-view').classList.remove('hidden');
                
                const container = document.getElementById('products-render-container');
                if(products.length === 0) {
                    container.innerHTML = `<p style="text-align:center; padding:40px; color:var(--text-muted);">–í —ç—Ç–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø–æ–∫–∞ –Ω–µ—Ç —Ç–æ–≤–∞—Ä–æ–≤...</p>`;
                } else {
                    container.innerHTML = products.map(p => `
                        <div class="product-card anim-slide" onclick="Payment.init(${p.id})">
                            <div class="prod-info">
                                <h3>${p.name}</h3>
                                <div class="prod-tags">
                                    <span class="tag">${p.lz_origin}</span>
                                    <span class="tag">Lolz Sync</span>
                                </div>
                            </div>
                            <div class="prod-price-box">
                                <div class="price">${p.price} ‚ÇΩ</div>
                                <div class="stock">–í –Ω–∞–ª–∏—á–∏–∏</div>
                            </div>
                        </div>
                    `).join('');
                }
                TG.HapticFeedback.impactOccurred('light');
            },

            updateStats() {
                document.getElementById('stat-orders').innerText = App.DB.orders.length;
                const total = App.DB.orders.reduce((acc, cur) => acc + cur.price, 0);
                document.getElementById('stat-spent').innerText = total + " ‚ÇΩ";
            }
        };

        // –ó–ê–ü–£–°–ö
        window.onload = () => UI.init();

    </script>
</body>
</html>
