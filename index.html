<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Digital Store Premium Edition v5.0</title>

    <!-- –í–Ω–µ—à–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: SDK Telegram –∏ Firebase -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>

    <style>
        /* 
        ========================================================================
        1. –°–¢–ò–õ–ò–ó–ê–¶–ò–Ø –ò –î–ò–ó–ê–ô–ù-–°–ò–°–¢–ï–ú–ê
        ========================================================================
        */
        :root {
            /* –ë–∞–∑–æ–≤–∞—è –ø–∞–ª–∏—Ç—Ä–∞ (Apple Style) */
            --bg-page: #f2f2f7;
            --bg-card: #ffffff;
            --text-main: #1c1c1e;
            --text-hint: #8e8e93;
            --accent: #007aff;
            --accent-light: rgba(0, 122, 255, 0.1);
            --border: #d1d1d6;
            --success: #34c759;
            --warning: #ff9500;
            --error: #ff3b30;
            
            /* –†–∞–∑–º–µ—Ä—ã –∏ —Å–∫—Ä—É–≥–ª–µ–Ω–∏—è */
            --radius-xl: 28px;
            --radius-lg: 20px;
            --radius-md: 14px;
            --radius-sm: 10px;
            
            /* –≠—Ñ—Ñ–µ–∫—Ç—ã */
            --shadow-soft: 0 10px 30px rgba(0,0,0,0.04);
            --shadow-hard: 0 20px 40px rgba(0,0,0,0.1);
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            --safe-bottom: env(safe-area-inset-bottom);
        }

        /* –¢–µ–º–Ω–∞—è —Ç–µ–º–∞ –¥–ª—è Telegram */
        @media (prefers-color-scheme: dark) {
            :root {
                --bg-page: #000000;
                --bg-card: #1c1c1e;
                --text-main: #ffffff;
                --text-hint: #98989d;
                --border: #38383a;
                --shadow-soft: 0 10px 40px rgba(0,0,0,0.4);
            }
        }

        * {
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            outline: none;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background-color: var(--bg-page);
            color: var(--text-main);
            margin: 0;
            padding: 0;
            overflow-x: hidden;
            line-height: 1.4;
            -webkit-font-smoothing: antialiased;
        }

        /* –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä */
        .app-container {
            max-width: 650px;
            margin: 0 auto;
            min-height: 100vh;
            padding: 20px 16px 140px;
            position: relative;
        }

        /* 
        ========================================================================
        2. –°–¢–†–ê–ù–ò–¶–´ –ò –ê–ù–ò–ú–ê–¶–ò–ò
        ========================================================================
        */
        .page {
            display: none;
            width: 100%;
            animation: slideIn 0.4s ease-out;
        }

        .page.active {
            display: block;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* 
        ========================================================================
        3. –¢–ò–ü–û–ì–†–ê–§–ò–ö–ê
        ========================================================================
        */
        h1 { font-size: 34px; font-weight: 800; margin: 0 0 10px; letter-spacing: -1.2px; }
        h2 { font-size: 22px; font-weight: 700; margin: 30px 0 15px; letter-spacing: -0.5px; }
        .sub-header { font-size: 16px; color: var(--text-hint); margin-bottom: 25px; }
        .section-label { font-size: 11px; font-weight: 800; text-transform: uppercase; color: var(--text-hint); letter-spacing: 1px; margin: 25px 4px 10px; display: block; }

        /* 
        ========================================================================
        4. –ö–ê–†–¢–û–ß–ö–ò –ò –ö–û–ú–ü–û–ù–ï–ù–¢–´
        ========================================================================
        */
        .card {
            background: var(--bg-card);
            border-radius: var(--radius-lg);
            padding: 24px;
            margin-bottom: 16px;
            box-shadow: var(--shadow-soft);
            border: 1px solid var(--border);
            transition: var(--transition);
        }

        .card:active {
            transform: scale(0.985);
        }

        .btn {
            background: var(--accent);
            color: #ffffff;
            border: none;
            padding: 16px 24px;
            border-radius: var(--radius-md);
            font-size: 17px;
            font-weight: 700;
            width: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            cursor: pointer;
            transition: var(--transition);
        }

        .btn:active {
            opacity: 0.8;
            transform: scale(0.97);
        }

        .btn-secondary { background: var(--border); color: var(--text-main); }
        .btn-outline { background: transparent; border: 2px solid var(--border); color: var(--text-main); }
        .btn-danger { color: var(--error); border-color: var(--error); background: transparent; }
        .btn-sm { padding: 10px 18px; font-size: 14px; border-radius: 12px; width: auto; }

        /* –§–æ—Ä–º—ã –≤–≤–æ–¥–∞ */
        .input-group { margin-bottom: 20px; }
        
        input, select, textarea {
            width: 100%;
            padding: 14px 16px;
            border-radius: var(--radius-md);
            border: 1.5px solid var(--border);
            background: var(--bg-card);
            color: var(--text-main);
            font-size: 16px;
            outline: none;
            transition: var(--transition);
        }

        input:focus, textarea:focus {
            border-color: var(--accent);
        }

        /* 
        ========================================================================
        5. –ù–ê–í–ò–ì–ê–¶–ò–Ø (TAB BAR)
        ========================================================================
        */
        .tab-bar {
            position: fixed;
            bottom: 0; left: 0; right: 0;
            background: rgba(var(--bg-card), 0.8);
            backdrop-filter: blur(25px);
            -webkit-backdrop-filter: blur(25px);
            display: flex;
            padding: 12px 0 calc(12px + var(--safe-bottom));
            border-top: 0.5px solid var(--border);
            z-index: 2000;
        }

        .tab-item {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            color: var(--text-hint);
            font-size: 10px;
            font-weight: 700;
            text-transform: uppercase;
            cursor: pointer;
            transition: color 0.2s;
        }

        .tab-item.active {
            color: var(--accent);
        }

        .tab-icon { font-size: 24px; }

        /* 
        ========================================================================
        6. –°–ü–ï–¶–ò–ê–õ–¨–ù–´–ï –≠–õ–ï–ú–ï–ù–¢–´ (–ú–ê–ì–ê–ó–ò–ù)
        ========================================================================
        */
        .cat-list {
            display: flex;
            gap: 10px;
            overflow-x: auto;
            padding: 10px 0 25px;
            margin: 0 -16px;
            padding-left: 16px;
            scrollbar-width: none;
        }
        .cat-list::-webkit-scrollbar { display: none; }

        .chip {
            background: var(--bg-card);
            padding: 10px 22px;
            border-radius: 30px;
            font-size: 14px;
            font-weight: 700;
            white-space: nowrap;
            border: 1.5px solid var(--border);
            color: var(--text-hint);
            transition: var(--transition);
        }

        .chip.active {
            background: var(--text-main);
            color: var(--bg-page);
            border-color: var(--text-main);
        }

        .price-tag {
            font-size: 22px;
            font-weight: 900;
            color: var(--accent);
        }

        /* 
        ========================================================================
        7. –ê–î–ú–ò–ù-–ü–ê–ù–ï–õ–¨ –≠–õ–ï–ú–ï–ù–¢–´
        ========================================================================
        */
        .stat-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 25px;
        }

        .stat-card {
            background: var(--bg-card);
            padding: 20px;
            border-radius: var(--radius-lg);
            border: 1px solid var(--border);
        }

        .stat-val { font-size: 28px; font-weight: 900; margin-bottom: 4px; }
        .stat-lbl { font-size: 12px; color: var(--text-hint); font-weight: 700; text-transform: uppercase; }

        .badge {
            padding: 5px 12px;
            border-radius: 10px;
            font-size: 11px;
            font-weight: 800;
            text-transform: uppercase;
        }
        .status-review { background: rgba(255, 149, 0, 0.1); color: var(--warning); }
        .status-done { background: rgba(52, 199, 89, 0.1); color: var(--success); }
        .status-reject { background: rgba(255, 59, 48, 0.1); color: var(--error); }

        /* 
        ========================================================================
        8. –°–ò–°–¢–ï–ú–ù–´–ï –≠–õ–ï–ú–ï–ù–¢–´
        ========================================================================
        */
        #global-loader {
            position: fixed; inset: 0;
            background: var(--bg-page);
            display: flex; flex-direction: column;
            align-items: center; justify-content: center;
            z-index: 5000;
        }

        .spinner {
            width: 44px; height: 44px;
            border: 4px solid var(--border);
            border-top-color: var(--accent);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin { to { transform: rotate(360deg); } }

        .hidden { display: none !important; }
        
        .img-preview {
            width: 100%;
            border-radius: 12px;
            margin: 15px 0;
            border: 1px solid var(--border);
            cursor: pointer;
            box-shadow: var(--shadow-soft);
        }

        .order-content-box {
            background: var(--bg-page);
            padding: 16px;
            border-radius: var(--radius-md);
            border: 1.5px dashed var(--border);
            font-family: "SF Mono", "Menlo", monospace;
            font-size: 13px;
            word-break: break-all;
            margin-top: 15px;
        }

        /* –ö–∞—Å—Ç–æ–º–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è */
        #toast {
            position: fixed;
            top: 20px; left: 50%;
            transform: translateX(-50%) translateY(-100px);
            background: var(--text-main);
            color: var(--bg-page);
            padding: 12px 24px;
            border-radius: 40px;
            font-weight: 700;
            font-size: 14px;
            z-index: 6000;
            transition: transform 0.4s cubic-bezier(0.18, 0.89, 0.32, 1.28);
            box-shadow: var(--shadow-hard);
        }
        #toast.active { transform: translateX(-50%) translateY(0); }
    </style>
</head>
<body>

    <!-- –°–∏—Å—Ç–µ–º–Ω—ã–π –ª–æ–∞–¥–µ—Ä -->
    <div id="global-loader">
        <div class="spinner"></div>
        <p style="margin-top: 20px; font-weight: 800; color: var(--text-hint);">–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö...</p>
    </div>

    <!-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è -->
    <div id="toast">–°–æ–æ–±—â–µ–Ω–∏–µ</div>

    <div class="app-container">

        <!-- –í–ò–¢–†–ò–ù–ê –ú–ê–ì–ê–ó–ò–ù–ê -->
        <section id="page-store" class="page active">
            <h1>–ú–∞–≥–∞–∑–∏–Ω</h1>
            <p class="sub-header">–¶–∏—Ñ—Ä–æ–≤—ã–µ —Ç–æ–≤–∞—Ä—ã —Å –º–≥–Ω–æ–≤–µ–Ω–Ω–æ–π –¥–æ—Å—Ç–∞–≤–∫–æ–π.</p>

            <div style="position: relative; margin-bottom: 25px;">
                <input type="text" id="store-search" placeholder="–ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–∞..." style="padding-left: 50px; border:none; box-shadow: var(--shadow-soft);" oninput="handleStoreSearch()">
                <span style="position:absolute; left:18px; top:15px; font-size:20px; opacity:0.6;">üîç</span>
            </div>

            <div class="cat-list" id="store-categories">
                <!-- –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ä–µ–Ω–¥–µ—Ä—è—Ç—Å—è —á–µ—Ä–µ–∑ JS -->
            </div>

            <div id="store-grid">
                <!-- –¢–æ–≤–∞—Ä—ã —Ä–µ–Ω–¥–µ—Ä—è—Ç—Å—è —á–µ—Ä–µ–∑ JS -->
            </div>
        </section>

        <!-- –û–§–û–†–ú–õ–ï–ù–ò–ï –ó–ê–ö–ê–ó–ê -->
        <section id="page-checkout" class="page">
            <div style="display:flex; align-items:center; gap:15px; margin-bottom:30px;">
                <button class="btn btn-secondary btn-sm" onclick="switchTab('store')">‚Üê –ù–∞–∑–∞–¥</button>
                <h1 style="margin:0;">–û–ø–ª–∞—Ç–∞</h1>
            </div>

            <div class="card">
                <span class="section-label" style="margin-top:0;">–í–∞—à–∏ —Ä–µ–∫–≤–∏–∑–∏—Ç—ã –¥–ª—è –æ–ø–ª–∞—Ç—ã</span>
                <div id="checkout-reks" style="font-size:18px; font-weight:700; background:rgba(0,0,0,0.03); padding:20px; border-radius:16px; white-space:pre-wrap; margin:10px 0;"></div>
                <div style="display:flex; justify-content:space-between; align-items:center; margin-top:25px;">
                    <span style="font-weight:700; font-size:17px;">–ò—Ç–æ–≥–æ –∫ –æ–ø–ª–∞—Ç–µ:</span>
                    <span class="price-tag" id="checkout-total">0 ‚ÇΩ</span>
                </div>
            </div>

            <div class="card">
                <span class="section-label" style="margin-top:0;">–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞</span>
                <p style="font-size:14px; margin-bottom:15px; color: var(--text-hint);">–ü—Ä–∏–∫—Ä–µ–ø–∏—Ç–µ —Å–∫—Ä–∏–Ω—à–æ—Ç —á–µ–∫–∞. –ú–æ–¥–µ—Ä–∞—Ü–∏—è –∑–∞–Ω–∏–º–∞–µ—Ç –¥–æ 15 –º–∏–Ω—É—Ç.</p>
                <input type="file" id="pay-file" accept="image/*">
                <button class="btn" style="margin-top:25px;" onclick="processOrderSubmission()">
                    –û—Ç–ø—Ä–∞–≤–∏—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± –æ–ø–ª–∞—Ç–µ
                </button>
            </div>
        </section>

        <!-- –ò–°–¢–û–†–ò–Ø –ó–ê–ö–ê–ó–û–í -->
        <section id="page-orders" class="page">
            <h1>–ó–∞–∫–∞–∑—ã</h1>
            <p class="sub-header">–í–∞—à–∞ –∏—Å—Ç–æ—Ä–∏—è –ø–æ–∫—É–ø–æ–∫ –∏ –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ.</p>
            <div id="orders-list">
                <!-- –°–ø–∏—Å–æ–∫ –∑–∞–∫–∞–∑–æ–≤ -->
            </div>
        </section>

        <!-- –ü–†–û–§–ò–õ–¨ -->
        <section id="page-profile" class="page">
            <h1>–ü—Ä–æ—Ñ–∏–ª—å</h1>
            <div class="card" style="text-align:center;">
                <div id="p-avatar" style="width:90px; height:90px; background:var(--accent); color:#fff; border-radius:50%; margin:0 auto 20px; display:flex; align-items:center; justify-content:center; font-size:36px; font-weight:900;">U</div>
                <div style="font-size:24px; font-weight:800;" id="p-name">Username</div>
                <p class="sub-header" id="p-id" style="margin-top:5px;">ID: 00000000</p>
            </div>
            
            <h2>–ü–æ–¥–¥–µ—Ä–∂–∫–∞</h2>
            <div class="card" onclick="contactSupport()">
                <div style="display:flex; justify-content:space-between; align-items:center;">
                    <div style="font-weight:700; font-size:17px;">–ù–∞–ø–∏—Å–∞—Ç—å –æ–ø–µ—Ä–∞—Ç–æ—Ä—É</div>
                    <span style="color:var(--text-hint); font-size:20px;">‚Üí</span>
                </div>
            </div>
        </section>

        <!-- –ê–î–ú–ò–ù-–ê–í–¢–û–†–ò–ó–ê–¶–ò–Ø -->
        <section id="page-admin-auth" class="page">
            <h1>–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è</h1>
            <div class="card">
                <label class="section-label">–ö–ª—é—á –¥–æ—Å—Ç—É–ø–∞</label>
                <input type="password" id="admin-password-field" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å...">
                <button class="btn" style="margin-top:20px;" onclick="handleAdminAuth()">–ê–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è</button>
            </div>
        </section>

        <!-- –ê–î–ú–ò–ù-–ü–ê–ù–ï–õ–¨ -->
        <section id="page-admin-dashboard" class="page">
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;">
                <h1 style="margin:0">–ö–æ–Ω—Å–æ–ª—å</h1>
                <button class="btn btn-secondary btn-sm" onclick="handleAdminLogout()">–í—ã–π—Ç–∏</button>
            </div>

            <div class="stat-grid">
                <div class="stat-card">
                    <div class="stat-val" id="adm-rev">0 ‚ÇΩ</div>
                    <div class="stat-lbl">–í—ã—Ä—É—á–∫–∞</div>
                </div>
                <div class="stat-card">
                    <div class="stat-val" id="adm-sales">0</div>
                    <div class="stat-lbl">–ó–∞–∫–∞–∑—ã</div>
                </div>
            </div>

            <div class="card">
                <h2 style="margin-top:0;">–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∏—Å—Ç–µ–º—ã</h2>
                
                <label class="section-label">–†–µ–∫–≤–∏–∑–∏—Ç—ã –ø–ª–∞—Ç–µ–∂–µ–π</label>
                <textarea id="set-reks" rows="3"></textarea>

                <label class="section-label">–Æ–∑–µ—Ä–Ω–µ–π–º –ø–æ–¥–¥–µ—Ä–∂–∫–∏ (–±–µ–∑ @)</label>
                <input type="text" id="set-support-link">

                <label class="section-label">ImgBB API Key</label>
                <input type="text" id="set-imgbb-key">

                <label class="section-label">Bot Token (Telegram)</label>
                <input type="text" id="set-bot-token">

                <label class="section-label">Admin Chat ID</label>
                <input type="text" id="set-admin-id">

                <label class="section-label">Lolz Market API Token</label>
                <input type="text" id="set-lolz-token">

                <label class="section-label">–ù–æ–≤—ã–π –ø–∞—Ä–æ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</label>
                <input type="text" id="set-admin-pass" placeholder="–û—Å—Ç–∞–≤—å—Ç–µ –ø—É—Å—Ç—ã–º –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–≥–æ">

                <button class="btn btn-sm" style="margin-top:20px;" onclick="updateGlobalSettings()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è</button>
            </div>

            <div class="card">
                <h2>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏</h2>
                <div style="display:flex; gap:10px; margin-bottom:15px;">
                    <input type="text" id="new-cat-input" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ...">
                    <button class="btn btn-sm" onclick="dbAddCategory()">+</button>
                </div>
                <div id="adm-categories-list"></div>
            </div>

            <div class="card">
                <h2>–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π —Ç–æ–≤–∞—Ä</h2>
                <div class="input-group">
                    <label class="section-label">–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞</label>
                    <input type="text" id="adm-p-name">
                </div>
                <div class="input-group">
                    <label class="section-label">–¶–µ–Ω–∞ (RUB)</label>
                    <input type="number" id="adm-p-price">
                </div>
                <div class="input-group">
                    <label class="section-label">–ö–∞—Ç–µ–≥–æ—Ä–∏—è</label>
                    <select id="adm-p-cat"></select>
                </div>
                <div class="input-group">
                    <label class="section-label">–ú–µ—Ç–æ–¥ –≤—ã–¥–∞—á–∏</label>
                    <select id="adm-p-type" onchange="toggleAdminProductTypeFields()">
                        <option value="text">–¢–µ–∫—Å—Ç (–ö–ª—é—á/–ê–∫–∫–∞—É–Ω—Ç)</option>
                        <option value="file">–§–∞–π–ª (–°—Å—ã–ª–∫–∞)</option>
                        <option value="lolz">Lolz Market (API –≤—ã–∫—É–ø)</option>
                    </select>
                </div>
                <div id="field-manual">
                    <label class="section-label">–ö–æ–Ω—Ç–µ–Ω—Ç —Ç–æ–≤–∞—Ä–∞ (–¥–∞–Ω–Ω—ã–µ –¥–ª—è –ø–æ–∫—É–ø–∞—Ç–µ–ª—è)</label>
                    <textarea id="adm-p-data" rows="3"></textarea>
                </div>
                <div id="field-lolz" class="hidden">
                    <label class="section-label">Lolz Search URL</label>
                    <input type="text" id="adm-p-lolz-url" placeholder="https://lzt.market/telegram/...">
                </div>
                <button class="btn" style="margin-top:15px;" onclick="dbAddProduct()">–û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –Ω–∞ –≤–∏—Ç—Ä–∏–Ω–µ</button>
            </div>

            <h2>–ó–∞–∫–∞–∑—ã –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–µ</h2>
            <div id="adm-reviews-list"></div>

            <h2>–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å —Ç–æ–≤–∞—Ä–æ–≤</h2>
            <div id="adm-inventory-list"></div>
        </section>

    </div>

    <!-- –¢–ê–ë-–ë–ê–† (–ú–ï–ù–Æ) -->
    <nav class="tab-bar">
        <div class="tab-item active" onclick="switchTab('store')">
            <span class="tab-icon">üõçÔ∏è</span>
            <span>–ú–∞–≥–∞–∑–∏–Ω</span>
        </div>
        <div class="tab-item" onclick="switchTab('orders')">
            <span class="tab-icon">üì¶</span>
            <span>–ó–∞–∫–∞–∑—ã</span>
        </div>
        <div class="tab-item" onclick="switchTab('profile')">
            <span class="tab-icon">üë§</span>
            <span>–ü—Ä–æ—Ñ–∏–ª—å</span>
        </div>
        <div class="tab-item" id="nav-adm-btn" onclick="switchTab('admin')">
            <span class="tab-icon">‚öôÔ∏è</span>
            <span>–ê–¥–º–∏–Ω</span>
        </div>
    </nav>

    <script>
        /* 
        ========================================================================
        9. CORE JS: –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –ò FIREBASE
        ========================================================================
        */
        
        // –í–ù–ò–ú–ê–ù–ò–ï: –í—Å—Ç–∞–≤—å—Ç–µ —Å–≤–æ–∏ –¥–∞–Ω–Ω—ã–µ Firebase —Å—é–¥–∞
        const firebaseConfig = {
            apiKey: "–í–ê–®_API_KEY",
            databaseURL: "https://–í–ê–®_PROJECT_ID.firebaseio.com",
            projectId: "–í–ê–®_PROJECT_ID",
        };

        firebase.initializeApp(firebaseConfig);
        const rdb = firebase.database();

        // –°–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        let appState = {
            products: {},
            categories: {},
            orders: {},
            settings: {},
            activeCategory: 'all',
            searchQuery: ''
        };

        const tg = window.Telegram.WebApp;
        const currentUser = tg.initDataUnsafe?.user || { id: 77777777, first_name: 'DevUser' };
        let selectedPId = null;

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        document.addEventListener('DOMContentLoaded', () => {
            tg.expand();
            
            // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ UI –ø—Ä–æ—Ñ–∏–ª—è
            document.getElementById('p-name').innerText = currentUser.first_name;
            document.getElementById('p-id').innerText = `ID: ${currentUser.id}`;
            document.getElementById('p-avatar').innerText = currentUser.first_name[0].toUpperCase();

            // Real-time –ø–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –≤—Å—é –±–∞–∑—É
            rdb.ref('/').on('value', snapshot => {
                const data = snapshot.val() || {};
                appState.products = data.products || {};
                appState.categories = data.categories || {};
                appState.orders = data.orders || {};
                appState.settings = data.settings || {};

                renderAllPages();
                document.getElementById('global-loader').style.display = 'none';
            });
        });

        /* 
        ========================================================================
        10. –†–û–£–¢–ò–ù–ì –ò –ò–ù–¢–ï–†–§–ï–ô–°
        ========================================================================
        */
        function switchTab(tabId) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.querySelectorAll('.tab-item').forEach(i => i.classList.remove('active'));

            let targetPage = `page-${tabId}`;
            if (tabId === 'admin') {
                targetPage = sessionStorage.getItem('isAdmin') ? 'page-admin-dashboard' : 'page-admin-auth';
            }

            document.getElementById(targetPage).classList.add('active');
            
            const navMap = { 'store': 0, 'orders': 1, 'profile': 2, 'admin': 3 };
            document.querySelectorAll('.tab-item')[navMap[tabId]].classList.add('active');
            
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function showToast(msg) {
            const t = document.getElementById('toast');
            t.innerText = msg;
            t.classList.add('active');
            setTimeout(() => t.classList.remove('active'), 3000);
        }

        /* 
        ========================================================================
        11. –õ–û–ì–ò–ö–ê –ú–ê–ì–ê–ó–ò–ù–ê (–í–ò–¢–†–ò–ù–ê)
        ========================================================================
        */
        function handleStoreSearch() {
            appState.searchQuery = document.getElementById('store-search').value.toLowerCase();
            renderStoreProducts();
        }

        function filterByCategory(catId) {
            appState.activeCategory = catId;
            renderStoreCategories();
            renderStoreProducts();
        }

        function renderAllPages() {
            renderStoreCategories();
            renderStoreProducts();
            renderUserOrders();
            if (sessionStorage.getItem('isAdmin')) renderAdminPanel();
        }

        function renderStoreCategories() {
            const cont = document.getElementById('store-categories');
            let html = `<div class="chip ${appState.activeCategory === 'all' ? 'active' : ''}" onclick="filterByCategory('all')">–í—Å–µ</div>`;
            
            Object.keys(appState.categories).forEach(id => {
                const c = appState.categories[id];
                html += `<div class="chip ${appState.activeCategory === id ? 'active' : ''}" onclick="filterByCategory('${id}')">${c.name}</div>`;
            });
            cont.innerHTML = html;
        }

        function renderStoreProducts() {
            const grid = document.getElementById('store-grid');
            grid.innerHTML = '';

            const productIds = Object.keys(appState.products).filter(id => {
                const p = appState.products[id];
                const matchCat = appState.activeCategory === 'all' || p.catId === appState.activeCategory;
                const matchSearch = p.name.toLowerCase().includes(appState.searchQuery);
                return matchCat && matchSearch;
            });

            if (productIds.length === 0) {
                grid.innerHTML = '<div style="text-align:center; padding:50px 0; color:var(--text-hint);">–¢–æ–≤–∞—Ä–æ–≤ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</div>';
                return;
            }

            productIds.forEach(id => {
                const p = appState.products[id];
                const el = document.createElement('div');
                el.className = 'card';
                el.innerHTML = `
                    <div style="display:flex; justify-content:space-between; align-items:flex-start;">
                        <div>
                            <div style="font-size:20px; font-weight:800;">${p.name}</div>
                            <div style="font-size:12px; color:var(--text-hint); margin-top:5px;">–ú–≥–Ω–æ–≤–µ–Ω–Ω–∞—è –≤—ã–¥–∞—á–∞ –ø–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã</div>
                        </div>
                        <div class="price-tag">${p.price} ‚ÇΩ</div>
                    </div>
                    <button class="btn btn-sm" style="width:100%; margin-top:20px;" onclick="openCheckout('${id}')">–ö—É–ø–∏—Ç—å —Ç–æ–≤–∞—Ä</button>
                `;
                grid.appendChild(el);
            });
        }

        /* 
        ========================================================================
        12. –û–ü–õ–ê–¢–ê –ò –ó–ê–ö–ê–ó–´
        ========================================================================
        */
        function openCheckout(productId) {
            selectedPId = productId;
            const p = appState.products[productId];
            document.getElementById('checkout-reks').innerText = appState.settings.reks || '–†–µ–∫–≤–∏–∑–∏—Ç—ã –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º.';
            document.getElementById('checkout-total').innerText = `${p.price} ‚ÇΩ`;
            
            // –ü—Ä—è—á–µ–º –≤–∏—Ç—Ä–∏–Ω—É, –æ—Ç–∫—Ä—ã–≤–∞–µ–º —á–µ–∫–∞—É—Ç
            document.getElementById('page-store').classList.remove('active');
            document.getElementById('page-checkout').classList.add('active');
        }

        async function processOrderSubmission() {
            const fileInput = document.getElementById('pay-file');
            const file = fileInput.files[0];
            const imgbbKey = appState.settings.imgbb;

            if (!file) return showToast('–í—ã–±–µ—Ä–∏—Ç–µ —Å–∫—Ä–∏–Ω—à–æ—Ç –æ–ø–ª–∞—Ç—ã');
            if (!imgbbKey) return showToast('–°–∏—Å—Ç–µ–º–∞ –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ (ImgBB)');

            setGlobalLoader(true, '–ó–∞–≥—Ä—É–∂–∞–µ–º —Å–∫—Ä–∏–Ω—à–æ—Ç —á–µ–∫–∞...');

            try {
                // 1. –ó–∞–≥—Ä—É–∑–∫–∞ —Å–∫—Ä–∏–Ω—à–æ—Ç–∞ –Ω–∞ ImgBB
                const fd = new FormData();
                fd.append('image', file);
                
                const imgRes = await fetch(`https://api.imgbb.com/1/upload?key=${imgbbKey}`, {
                    method: 'POST', body: fd
                });
                const imgData = await imgRes.json();
                if (!imgData.success) throw new Error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ ImgBB');

                const product = appState.products[selectedPId];
                const orderId = 'ORD' + Date.now();
                
                const orderPayload = {
                    id: orderId,
                    uId: currentUser.id,
                    uName: currentUser.first_name + (currentUser.username ? ` (@${currentUser.username})` : ''),
                    pId: selectedPId,
                    pName: product.name,
                    price: Number(product.price),
                    screenshot: imgData.data.url,
                    status: 'review',
                    date: new Date().toLocaleString('ru-RU')
                };

                // 2. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ Firebase
                await rdb.ref('orders/' + orderId).set(orderPayload);

                // 3. –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –≤ –±–æ—Ç–∞
                await sendAdminBotNotify(orderPayload);

                showToast('–ó–∞–∫–∞–∑ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫—É!');
                fileInput.value = '';
                switchTab('orders');

            } catch (err) {
                alert('–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞: ' + err.message);
            } finally {
                setGlobalLoader(false);
            }
        }

        async function sendAdminBotNotify(o) {
            const token = appState.settings.bot;
            const chatId = appState.settings.chatid;
            if (!token || !chatId) return;

            const text = `üíé <b>–ù–û–í–´–ô –ó–ê–ö–ê–ó!</b>\n\n` +
                         `üë§ –ö–ª–∏–µ–Ω—Ç: ${o.uName}\n` +
                         `üõç –¢–æ–≤–∞—Ä: ${o.pName}\n` +
                         `üí∞ –°—É–º–º–∞: ${o.price} ‚ÇΩ\n\n` +
                         `üñº <a href="${o.screenshot}">–°–º–æ—Ç—Ä–µ—Ç—å —Å–∫—Ä–∏–Ω—à–æ—Ç –æ–ø–ª–∞—Ç—ã</a>`;
            
            try {
                await fetch(`https://api.telegram.org/bot${token}/sendMessage`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({ chat_id: chatId, text: text, parse_mode: 'HTML' })
                });
            } catch (e) { console.error('Notify Error', e); }
        }

        /* 
        ========================================================================
        13. –õ–ò–ß–ù–´–ô –ö–ê–ë–ò–ù–ï–¢ (–ó–ê–ö–ê–ó–´)
        ========================================================================
        */
        function renderUserOrders() {
            const cont = document.getElementById('orders-list');
            const myOrders = Object.values(appState.orders)
                                .filter(o => o.uId == currentUser.id)
                                .sort((a, b) => b.id.localeCompare(a.id));

            if (myOrders.length === 0) {
                cont.innerHTML = '<div style="text-align:center; padding:60px 0; color:var(--text-hint);">–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –∑–∞–∫–∞–∑–æ–≤</div>';
                return;
            }

            cont.innerHTML = myOrders.map(o => `
                <div class="card">
                    <div style="display:flex; justify-content:space-between; margin-bottom:15px;">
                        <div>
                            <div style="font-weight:800; font-size:18px;">${o.pName}</div>
                            <div style="font-size:12px; color:var(--text-hint);">${o.date}</div>
                        </div>
                        <span class="badge status-${o.status}">${o.status === 'review' ? '–ü—Ä–æ–≤–µ—Ä–∫–∞' : (o.status === 'done' ? '–í—ã–¥–∞–Ω' : '–û—Ç–∫–∞–∑')}</span>
                    </div>
                    <div class="price-tag" style="font-size:18px; margin-bottom:12px;">${o.price} ‚ÇΩ</div>
                    ${o.status === 'done' ? `
                        <div class="order-content-box">
                            <b style="color:var(--success)">–î–ê–ù–ù–´–ï –¢–û–í–ê–†–ê:</b><br><br>${o.data}
                        </div>
                    ` : ''}
                </div>
            `).join('');
        }

        function contactSupport() {
            const s = appState.settings.support;
            if (s) tg.openTelegramLink(`https://t.me/${s}`);
            else showToast('–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞');
        }

        /* 
        ========================================================================
        14. –ê–î–ú–ò–ù-–õ–û–ì–ò–ö–ê (AUTH & DASHBOARD)
        ========================================================================
        */
        function handleAdminAuth() {
            const passInput = document.getElementById('admin-password-field').value;
            const masterPass = appState.settings.adminPass || 'admin';
            
            if (passInput === masterPass) {
                sessionStorage.setItem('isAdmin', 'true');
                switchTab('admin');
            } else {
                showToast('–ù–µ–≤–µ—Ä–Ω—ã–π –∫–ª—é—á –¥–æ—Å—Ç—É–ø–∞');
            }
        }

        function handleAdminLogout() {
            sessionStorage.removeItem('isAdmin');
            location.reload();
        }

        function toggleAdminProductTypeFields() {
            const type = document.getElementById('adm-p-type').value;
            document.getElementById('field-manual').classList.toggle('hidden', type === 'lolz');
            document.getElementById('field-lolz').classList.toggle('hidden', type !== 'lolz');
        }

        function renderAdminPanel() {
            const s = appState.settings;
            document.getElementById('set-reks').value = s.reks || '';
            document.getElementById('set-support-link').value = s.support || '';
            document.getElementById('set-imgbb-key').value = s.imgbb || '';
            document.getElementById('set-bot-token').value = s.bot || '';
            document.getElementById('set-admin-id').value = s.chatid || '';
            document.getElementById('set-lolz-token').value = s.lolz || '';

            // –°—á—ë—Ç—á–∏–∫–∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏
            const successfulOrders = Object.values(appState.orders).filter(o => o.status === 'done');
            const totalRev = successfulOrders.reduce((sum, o) => sum + Number(o.price), 0);
            document.getElementById('adm-rev').innerText = `${totalRev} ‚ÇΩ`;
            document.getElementById('adm-sales').innerText = successfulOrders.length;

            // –ö–∞—Ç–µ–≥–æ—Ä–∏–∏
            const cSel = document.getElementById('adm-p-cat');
            const cList = document.getElementById('adm-categories-list');
            cSel.innerHTML = ''; cList.innerHTML = '';
            
            Object.keys(appState.categories).forEach(id => {
                const c = appState.categories[id];
                cSel.innerHTML += `<option value="${id}">${c.name}</option>`;
                cList.innerHTML += `
                    <div style="display:flex; justify-content:space-between; padding:10px 0; border-bottom:1px solid var(--border);">
                        <span>${c.name}</span>
                        <span style="color:var(--error); font-weight:800; cursor:pointer;" onclick="dbDeleteCategory('${id}')">–£–¥–∞–ª–∏—Ç—å</span>
                    </div>
                `;
            });

            // –ó–∞–∫–∞–∑—ã –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫—É
            const revList = document.getElementById('adm-reviews-list');
            const pendingOrders = Object.values(appState.orders).filter(o => o.status === 'review');
            revList.innerHTML = pendingOrders.map(o => `
                <div class="card" style="border-left:6px solid var(--warning);">
                    <div style="font-weight:800; font-size:18px;">${o.pName} | ${o.price} ‚ÇΩ</div>
                    <div style="font-size:12px; margin:5px 0;">–ö–ª–∏–µ–Ω—Ç: ${o.uName}</div>
                    <img src="${o.screenshot}" class="img-preview" onclick="window.open('${o.screenshot}')">
                    <div style="display:flex; gap:12px; margin-top:15px;">
                        <button class="btn btn-sm" style="flex:1" onclick="approveOrder('${o.id}')">–ü—Ä–∏–Ω—è—Ç—å</button>
                        <button class="btn btn-sm btn-outline btn-danger" style="flex:1" onclick="updateOrderStatus('${o.id}', 'reject')">–û—Ç–∫–∞–∑</button>
                    </div>
                </div>
            `).join('') || '<p style="color:var(--text-hint); font-size:13px; text-align:center;">–ù–æ–≤—ã—Ö –∑–∞–∫–∞–∑–æ–≤ –Ω–µ—Ç</p>';

            // –ò–Ω–≤–µ–Ω—Ç–∞—Ä—å —Ç–æ–≤–∞—Ä–æ–≤
            const invList = document.getElementById('adm-inventory-list');
            invList.innerHTML = Object.keys(appState.products).map(id => `
                <div style="display:flex; justify-content:space-between; align-items:center; padding:15px 0; border-bottom:1px solid var(--border);">
                    <div>
                        <div style="font-weight:700;">${appState.products[id].name}</div>
                        <div style="font-size:11px; color:var(--text-hint);">${appState.products[id].price} ‚ÇΩ ‚Ä¢ ${appState.products[id].type}</div>
                    </div>
                    <button class="btn btn-sm btn-danger" onclick="dbDeleteProduct('${id}')">–£–¥–∞–ª–∏—Ç—å</button>
                </div>
            `).join('');
        }

        /* 
        ========================================================================
        15. DATABASE OPERATIONS (CRUD)
        ========================================================================
        */
        async function approveOrder(orderId) {
            const order = appState.orders[orderId];
            const product = appState.products[order.productId];
            
            setGlobalLoader(true, '–í—ã–¥–∞—á–∞ —Ç–æ–≤–∞—Ä–∞ –ø–æ–∫—É–ø–∞—Ç–µ–ª—é...');

            try {
                let dataToDeliver = "";
                
                if (product.type === 'lolz') {
                    dataToDeliver = await performLolzAutoPurchase(product.lolzUrl);
                } else {
                    dataToDeliver = product.data || "–ö–æ–Ω—Ç–µ–Ω—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω";
                }

                await rdb.ref(`orders/${orderId}`).update({
                    status: 'done',
                    data: dataToDeliver
                });
                
                showToast('–ó–∞–∫–∞–∑ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω!');
            } catch (err) {
                alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –≤—ã–¥–∞—á–µ: ' + err.message + '. –í—ã –º–æ–∂–µ—Ç–µ –æ—Ç–∫–ª–æ–Ω–∏—Ç—å –∑–∞–∫–∞–∑ –∏–ª–∏ –≤—ã–¥–∞—Ç—å –µ–≥–æ –≤—Ä—É—á–Ω—É—é –≤ –õ–°.');
            } finally {
                setGlobalLoader(false);
            }
        }

        async function performLolzAutoPurchase(searchUrl) {
            const token = appState.settings.lolz;
            if (!token) throw new Error('Lolz Token –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –≤ –∞–¥–º–∏–Ω–∫–µ');

            // –ü—Ä–æ–∫—Å–∏ –¥–ª—è –æ–±—Ö–æ–¥–∞ CORS. –í–ù–ò–ú–ê–ù–ò–ï: –ï—Å–ª–∏ —ç—Ç–æ—Ç –ø—Ä–æ–∫—Å–∏ —É–ø–∞–¥–µ—Ç, –∞–≤—Ç–æ–≤—ã–∫—É–ø –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–µ—Ç.
            const proxy = "https://corsproxy.io/?"; 
            const cleanUrl = searchUrl.includes('?') ? `https://api.lzt.market/list?${searchUrl.split('?')[1]}` : `https://api.lzt.market/list`;
            
            const targetUrl = proxy + encodeURIComponent(cleanUrl);

            try {
                const response = await fetch(targetUrl, {
                    headers: { 'Authorization': `Bearer ${token}` }
                });

                if (!response.ok) throw new Error(`Lolz Market Error ${response.status}`);

                const result = await response.json();
                if (!result.items || result.items.length === 0) throw new Error('–ù–∞ Lolz –Ω–µ—Ç –ø–æ–¥—Ö–æ–¥—è—â–∏—Ö —Ç–æ–≤–∞—Ä–æ–≤');
                
                const item = result.items[0];
                // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –¥–∞–Ω–Ω—ã–µ. –ü–æ–ª–Ω—ã–π –∞–≤—Ç–æ–≤—ã–∫—É–ø (confirm-buy) —Ç—Ä–µ–±—É–µ—Ç POST, —á—Ç–æ —á–µ—Ä–µ–∑ –ø—Ä–æ–∫—Å–∏ –¥–µ–ª–∞—Ç—å —Å–ª–æ–∂–Ω–µ–µ.
                // –ü–æ—ç—Ç–æ–º—É –≤—ã–¥–∞–µ–º —Å—Å—ã–ª–∫—É –Ω–∞ —Ç–æ–≤–∞—Ä –∏ –¥–∞–Ω–Ω—ã–µ.
                return `–ê–∫–∫–∞—É–Ω—Ç –Ω–∞–π–¥–µ–Ω –Ω–∞ –ú–∞—Ä–∫–µ—Ç–µ!\nID: ${item.item_id}\n–ó–∞–≥–æ–ª–æ–≤–æ–∫: ${item.item_title}\n–¶–µ–Ω–∞: ${item.price} ${item.currency}\n\n–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–∞—à–∏ –ø–æ–∫—É–ø–∫–∏ –Ω–∞ lzt.market –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ–ª–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.`;
            } catch (e) {
                throw new Error("–ù–µ —É–¥–∞–ª–æ—Å—å —Å–≤—è–∑–∞—Ç—å—Å—è —Å API Lolz. –í–æ–∑–º–æ–∂–Ω–æ, —Å–µ—Ä–≤–∏—Å –ø—Ä–æ–∫—Å–∏ –ø–µ—Ä–µ–≥—Ä—É–∂–µ–Ω.");
            }
        }

        function updateOrderStatus(id, status) {
            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã?')) {
                rdb.ref(`orders/${id}/status`).set(status);
            }
        }

        function updateGlobalSettings() {
            const newPass = document.getElementById('set-admin-pass').value;
            const payload = {
                reks: document.getElementById('set-reks').value,
                support: document.getElementById('set-support-link').value,
                imgbb: document.getElementById('set-imgbb-key').value,
                bot: document.getElementById('set-bot-token').value,
                chatid: document.getElementById('set-admin-id').value,
                lolz: document.getElementById('set-lolz-token').value,
                adminPass: newPass || appState.settings.adminPass || 'admin'
            };
            
            rdb.ref('settings').set(payload).then(() => {
                showToast('–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–±–Ω–æ–≤–ª–µ–Ω—ã');
                document.getElementById('set-admin-pass').value = '';
            });
        }

        function dbAddCategory() {
            const name = document.getElementById('new-cat-input').value;
            if (!name) return;
            rdb.ref('categories').push({ name: name }).then(() => {
                document.getElementById('new-cat-input').value = '';
                showToast('–ö–∞—Ç–µ–≥–æ—Ä–∏—è —Å–æ–∑–¥–∞–Ω–∞');
            });
        }

        function dbDeleteCategory(id) {
            if (confirm('–£–¥–∞–ª–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é? –¢–æ–≤–∞—Ä—ã –æ—Å—Ç–∞–Ω—É—Ç—Å—è –±–µ–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏.')) {
                rdb.ref(`categories/${id}`).remove();
            }
        }

        function dbAddProduct() {
            const name = document.getElementById('adm-p-name').value;
            const price = document.getElementById('adm-p-price').value;
            const catId = document.getElementById('adm-p-cat').value;
            const type = document.getElementById('adm-p-type').value;
            const data = document.getElementById('adm-p-data').value;
            const lolzUrl = document.getElementById('adm-p-lolz-url').value;

            if (!name || !price || !catId) return showToast('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è');

            const payload = {
                name, 
                price: Number(price), 
                catId, 
                type,
                data: type === 'lolz' ? '' : data,
                lolzUrl: type === 'lolz' ? lolzUrl : ''
            };

            rdb.ref('products').push(payload).then(() => {
                showToast('–¢–æ–≤–∞—Ä –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω');
                // –°–±—Ä–æ—Å –ø–æ–ª–µ–π
                document.getElementById('adm-p-name').value = '';
                document.getElementById('adm-p-price').value = '';
                document.getElementById('adm-p-data').value = '';
                document.getElementById('adm-p-lolz-url').value = '';
            });
        }

        function dbDeleteProduct(id) {
            if (confirm('–£–¥–∞–ª–∏—Ç—å —Ç–æ–≤–∞—Ä?')) {
                rdb.ref(`products/${id}`).remove();
            }
        }

        /* 
        ========================================================================
        16. HELPERS & UTILS
        ========================================================================
        */
        function setGlobalLoader(show, text = '–ó–∞–≥—Ä—É–∑–∫–∞...') {
            const l = document.getElementById('global-loader');
            l.style.display = show ? 'flex' : 'none';
            l.querySelector('p').innerText = text;
        }

    </script>
</body>
</html>

