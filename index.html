<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Zikrov Premium Market Monolith v8.0</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        /* =========================================
           1. CORE STYLES & DESIGN SYSTEM (CSS)
           =========================================
        */
        :root {
            --bg-black: #000000;
            --bg-dark: #121212;
            --bg-card: #1c1c1e;
            --accent-blue: #007aff;
            --accent-blue-dim: rgba(0, 122, 255, 0.15);
            --accent-green: #34c759;
            --accent-red: #ff3b30;
            --text-main: #ffffff;
            --text-gray: #8e8e93;
            --border-color: rgba(255, 255, 255, 0.1);
            --glass: rgba(28, 28, 30, 0.8);
            --safe-bottom: env(safe-area-inset-bottom);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, "SF Pro Display", sans-serif;
            background: var(--bg-black);
            color: var(--text-main);
            overflow-x: hidden;
            line-height: 1.5;
            padding-bottom: calc(100px + var(--safe-bottom));
        }

        /* LAYOUT COMPONENTS */
        .app-container { width: 100%; max-width: 500px; margin: 0 auto; padding: 20px; }
        
        .section-title { font-size: 24px; font-weight: 800; margin-bottom: 5px; }
        .section-desc { font-size: 14px; color: var(--text-gray); margin-bottom: 25px; }

        /* ADVANCED ANIMATIONS */
        @keyframes fadeSlideUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .animated { animation: fadeSlideUp 0.5s cubic-bezier(0.2, 0.8, 0.2, 1); }

        /* CARD ENGINE */
        .category-card {
            background: var(--bg-card);
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 15px;
            border: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            gap: 15px;
            transition: 0.3s;
        }

        .category-card:active { transform: scale(0.97); background: #2c2c2e; }

        .icon-box {
            width: 50px; height: 50px;
            background: var(--accent-blue-dim);
            border-radius: 12px;
            display: flex; align-items: center; justify-content: center;
            font-size: 24px; color: var(--accent-blue);
        }

        .card-info { flex: 1; }
        .card-info h3 { font-size: 17px; font-weight: 700; }
        .card-info p { font-size: 13px; color: var(--text-gray); }

        .price-badge {
            background: var(--accent-blue);
            padding: 6px 12px;
            border-radius: 10px;
            font-weight: 700;
            font-size: 14px;
        }

        /* NAVIGATION BAR */
        .nav-bar {
            position: fixed; bottom: 0; left: 0; right: 0;
            height: 85px; background: var(--glass);
            backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px);
            display: flex; justify-content: space-around;
            padding-bottom: var(--safe-bottom);
            border-top: 1px solid var(--border-color);
            z-index: 999;
        }

        .nav-btn {
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            color: var(--text-gray); font-size: 10px; font-weight: 600; width: 25%;
        }

        .nav-btn.active { color: var(--accent-blue); }
        .nav-btn svg { width: 24px; height: 24px; margin-bottom: 4px; fill: currentColor; }

        /* MODAL ENGINE */
        .modal-overlay {
            position: fixed; top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.85); display: none; z-index: 1000;
            align-items: flex-end; backdrop-filter: blur(10px);
        }

        .modal-content {
            background: var(--bg-card); width: 100%; border-radius: 30px 30px 0 0;
            padding: 30px 20px; transform: translateY(100%); transition: 0.4s;
            max-height: 90vh; overflow-y: auto;
        }

        .modal-overlay.active { display: flex; }
        .modal-overlay.active .modal-content { transform: translateY(0); }

        /* BUTTONS */
        .btn {
            border: none; border-radius: 15px; font-weight: 700; cursor: pointer;
            display: flex; align-items: center; justify-content: center; transition: 0.2s;
            width: 100%; padding: 18px; font-size: 16px;
        }
        .btn-main { background: var(--accent-blue); color: #fff; }
        .btn-outline { background: transparent; border: 1px solid var(--border-color); color: #fff; }
        .btn-success { background: var(--accent-green); color: #fff; }
        .btn:active { transform: scale(0.98); opacity: 0.8; }

        /* TERMINAL / ADMIN */
        .admin-log {
            background: #000; border-radius: 10px; padding: 10px;
            font-family: monospace; font-size: 11px; color: #00ff00;
            height: 150px; overflow-y: auto; margin: 10px 0;
            border: 1px solid #333;
        }

        /* INPUTS */
        .input-field {
            width: 100%; background: #2c2c2e; border: 1px solid var(--border-color);
            border-radius: 12px; padding: 15px; color: #fff; margin-bottom: 15px; outline: none;
        }
    </style>
</head>
<body>

    <div id="view-market" class="view active animated">
        <div class="app-container">
            <header class="section-header">
                <h1 class="section-title">Zikrov Market</h1>
                <p class="section-desc">–≠–ª–∏—Ç–Ω—ã–µ —Ü–∏—Ñ—Ä–æ–≤—ã–µ —Ç–æ–≤–∞—Ä—ã</p>
            </header>
            
            <div id="category-wrapper">
                <div id="cat-list"></div>
            </div>

            <div id="product-wrapper" style="display: none;">
                <button class="btn btn-outline" style="width: auto; padding: 8px 15px; margin-bottom: 15px;" onclick="Engine.Router.toCategories()">‚Üê –ù–∞–∑–∞–¥</button>
                <h2 id="current-cat-name" style="margin-bottom: 20px;">–¢–æ–≤–∞—Ä—ã</h2>
                <div id="prod-list"></div>
            </div>
        </div>
    </div>

    <div id="view-profile" class="view animated" style="display: none;">
        <div class="app-container">
            <h1 class="section-title">–°–∏—Å—Ç–µ–º–∞</h1>
            <p class="section-desc">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</p>
            
            <div class="category-card">
                <div class="icon-box">üë§</div>
                <div class="card-info">
                    <h3 id="user-name">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</h3>
                    <p id="user-id-tag">ID: 00000000</p>
                </div>
            </div>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 20px;">
                <div class="category-card" style="margin-bottom: 0; flex-direction: column; align-items: flex-start;">
                    <p style="font-size: 11px; color: var(--text-gray);">–ó–ê–ö–ê–ó–û–í</p>
                    <h2 id="stat-count">0</h2>
                </div>
                <div class="category-card" style="margin-bottom: 0; flex-direction: column; align-items: flex-start;">
                    <p style="font-size: 11px; color: var(--text-gray);">–¢–†–ê–¢–´</p>
                    <h2 id="stat-sum">0 ‚ÇΩ</h2>
                </div>
            </div>

            <button class="btn btn-outline" onclick="Engine.History.show()">üìë –ò—Å—Ç–æ—Ä–∏—è –∑–∞–∫–∞–∑–æ–≤</button>

            <div id="admin-zone" style="display: none; margin-top: 30px;">
                <h3 style="color: var(--accent-red); margin-bottom: 10px;">ROOT ACCESS</h3>
                <div class="admin-log" id="admin-log-stream">> Initializing kernel...<br>> Security check passed.</div>
                <button class="btn btn-main" style="background: var(--accent-red);" onclick="Engine.Admin.configurePrices()">–ù–ê–°–¢–†–û–ò–¢–¨ –¶–ï–ù–´ LOLZ</button>
            </div>
        </div>
    </div>

    <div id="modal-pay" class="modal-overlay" onclick="Engine.UI.closeModals()">
        <div class="modal-content" onclick="event.stopPropagation()">
            <h2 id="pay-title">–ó–∞–∫–∞–∑ —Ç–æ–≤–∞—Ä–∞</h2>
            <div id="pay-body" style="margin: 20px 0;">
                </div>
            <div id="pay-actions">
                <button class="btn btn-main" onclick="Engine.Payment.confirm()">–ü–û–î–¢–í–ï–†–î–ò–¢–¨ –û–ü–õ–ê–¢–£</button>
            </div>
        </div>
    </div>

    <nav class="nav-bar">
        <div class="nav-btn active" onclick="Engine.Router.switch('market', this)">
            <svg viewBox="0 0 24 24"><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/></svg>
            <span>–ú–ê–†–ö–ï–¢</span>
        </div>
        <div class="nav-btn" onclick="Engine.Router.switch('profile', this)">
            <svg viewBox="0 0 24 24"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg>
            <span>–ü–†–û–§–ò–õ–¨</span>
        </div>
    </nav>

    <script>
        const TG = window.Telegram.WebApp;
        TG.expand();

        /**
         * –ì–õ–û–ë–ê–õ–¨–ù–´–ô –û–ë–™–ï–ö–¢ –î–í–ò–ñ–ö–ê
         */
        const Engine = {
            Config: {
                ADMIN_ID: 1577146268, // <-- –í–ê–® ID –¢–£–¢
                CURRENCY: '‚ÇΩ',
                PAYMENT_REQUISITES: '+79009389328 (–°–ë–ï–†)',
                API_DELAY: 2000
            },

            // –ë–ê–ó–ê –î–ê–ù–ù–´–• –¢–û–í–ê–†–û–í (–ü–û–õ–ù–´–ô –°–ü–ò–°–û–ö)
            DB: [
                {
                    id: 'cat_tg_reg',
                    name: 'Telegram (–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è)',
                    icon: 'üì±',
                    items: [
                        { id: 'tg1', name: '–ì–µ—Ä–º–∞–Ω–∏—è +49', price: 290, market_tag: 'germany' },
                        { id: 'tg2', name: '–ö–∞–∑–∞—Ö—Å—Ç–∞–Ω +7', price: 190, market_tag: 'kazakhstan' },
                        { id: 'tg3', name: '–°–®–ê +1', price: 65, market_tag: 'usa' },
                        { id: 'tg4', name: '–¢—É—Ä—Ü–∏—è +90', price: 145, market_tag: 'turkey' },
                        { id: 'tg5', name: '–ò–Ω–¥–æ–Ω–µ–∑–∏—è +62', price: 110, market_tag: 'indonesia' },
                        { id: 'tg6', name: '–í—å–µ—Ç–Ω–∞–º +84', price: 85, market_tag: 'vietnam' },
                        { id: 'tg7', name: '–§—Ä–∞–Ω—Ü–∏—è +33', price: 310, market_tag: 'france' },
                        { id: 'tg8', name: '–ê–Ω–≥–ª–∏—è +44', price: 280, market_tag: 'uk' }
                    ]
                },
                {
                    id: 'cat_tg_aged',
                    name: 'Telegram (–û—Ç–ª–µ–≥–∞)',
                    icon: '‚è≥',
                    items: [
                        { id: 'old1', name: '–û—Ç–ª–µ–≥–∞ 30-60 –¥–Ω–µ–π', price: 450, market_tag: 'aged_30' },
                        { id: 'old2', name: '–û—Ç–ª–µ–≥–∞ 6 –º–µ—Å—è—Ü–µ–≤+', price: 1100, market_tag: 'aged_180' },
                        { id: 'old3', name: '–ê–∫–∫–∞—É–Ω—Ç—ã —Å Premium', price: 1500, market_tag: 'premium' },
                        { id: 'old4', name: '–ß–∏—Å—Ç—ã–µ (Old)', price: 800, market_tag: 'old_clean' }
                    ]
                },
                {
                    id: 'cat_soft',
                    name: '–°–æ—Ñ—Ç—ã –∏ –ö–ª—é—á–∏',
                    icon: 'üõ†',
                    items: [
                        { id: 's1', name: 'VPN 1 Month Premium', price: 150, market_tag: 'vpn' },
                        { id: 's2', name: 'Discord Nitro Full', price: 390, market_tag: 'nitro' },
                        { id: 's3', name: 'Spotify Premium 1m', price: 240, market_tag: 'spotify' },
                        { id: 's4', name: 'ChatGPT Plus Shared', price: 600, market_tag: 'gpt' }
                    ]
                }
            ],

            State: {
                activeCategory: null,
                selectedProduct: null,
                history: JSON.parse(localStorage.getItem('zik_orders') || '[]'),
                user: TG.initDataUnsafe.user || { id: 0, first_name: 'Debug' }
            },

            // –ú–û–î–£–õ–¨ –†–û–£–¢–ò–ù–ì–ê
            Router: {
                switch(view, btn) {
                    document.querySelectorAll('.view').forEach(v => v.style.display = 'none');
                    document.getElementById(`view-${view}`).style.display = 'block';
                    document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    TG.HapticFeedback.selectionChanged();
                },
                toProducts(catId) {
                    const cat = Engine.DB.find(c => c.id === catId);
                    Engine.State.activeCategory = cat;
                    document.getElementById('cat-list').style.display = 'none';
                    document.getElementById('product-wrapper').style.display = 'block';
                    document.getElementById('current-cat-name').innerText = cat.name;
                    Engine.UI.renderProducts(cat.items);
                },
                toCategories() {
                    document.getElementById('cat-list').style.display = 'grid';
                    document.getElementById('product-wrapper').style.display = 'none';
                }
            },

            // –ú–û–î–£–õ–¨ –ò–ù–¢–ï–†–§–ï–ô–°–ê
            UI: {
                init() {
                    this.renderCategories();
                    this.updateProfile();
                    if(Engine.State.user.id === Engine.Config.ADMIN_ID) {
                        document.getElementById('admin-zone').style.display = 'block';
                    }
                },
                renderCategories() {
                    const container = document.getElementById('cat-list');
                    container.innerHTML = Engine.DB.map(cat => `
                        <div class="category-card" onclick="Engine.Router.toProducts('${cat.id}')">
                            <div class="icon-box">${cat.icon}</div>
                            <div class="card-info">
                                <h3>${cat.name}</h3>
                                <p>${cat.items.length} –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –≤ –Ω–∞–ª–∏—á–∏–∏</p>
                            </div>
                            <div style="color: var(--text-gray);">‚Üí</div>
                        </div>
                    `).join('');
                },
                renderProducts(items) {
                    const container = document.getElementById('prod-list');
                    container.innerHTML = items.map(p => `
                        <div class="category-card" onclick="Engine.UI.openPayment('${p.id}')">
                            <div class="card-info">
                                <h3>${p.name}</h3>
                                <p>Lolz Market Source</p>
                            </div>
                            <div class="price-badge">${p.price} ‚ÇΩ</div>
                        </div>
                    `).join('');
                },
                updateProfile() {
                    document.getElementById('user-name').innerText = Engine.State.user.first_name;
                    document.getElementById('user-id-tag').innerText = "ID: " + Engine.State.user.id;
                    document.getElementById('stat-count').innerText = Engine.State.history.length;
                    const total = Engine.State.history.reduce((a, b) => a + b.price, 0);
                    document.getElementById('stat-sum').innerText = total + " ‚ÇΩ";
                },
                openPayment(prodId) {
                    const prod = Engine.State.activeCategory.items.find(i => i.id === prodId);
                    Engine.State.selectedProduct = prod;
                    
                    document.getElementById('pay-title').innerText = prod.name;
                    document.getElementById('pay-body').innerHTML = `
                        <div style="background: rgba(255,255,255,0.05); padding: 15px; border-radius: 15px;">
                            <p style="color: var(--text-gray); font-size: 12px;">–°–£–ú–ú–ê –ö –û–ü–õ–ê–¢–ï</p>
                            <h2 style="color: var(--accent-blue);">${prod.price} ‚ÇΩ</h2>
                            <hr style="border: none; border-top: 1px solid #333; margin: 10px 0;">
                            <p style="font-size: 13px; margin-bottom: 5px;">–ü–µ—Ä–µ–≤–µ–¥–∏—Ç–µ –Ω–∞ –∫–∞—Ä—Ç—É/–°–ë–ü:</p>
                            <code style="display: block; background: #000; padding: 10px; border-radius: 8px; font-size: 14px;">${Engine.Config.PAYMENT_REQUISITES}</code>
                        </div>
                        <p style="font-size: 11px; color: var(--text-gray); margin-top: 15px;">–ü–æ—Å–ª–µ –ø–µ—Ä–µ–≤–æ–¥–∞ –Ω–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É. –ë–æ—Ç –ø—Ä–æ–≤–µ—Ä–∏—Ç –∑–∞—á–∏—Å–ª–µ–Ω–∏–µ –∏ –≤—ã–∫—É–ø–∏—Ç —Ç–æ–≤–∞—Ä –Ω–∞ Lolz Market.</p>
                    `;
                    document.getElementById('modal-pay').classList.add('active');
                    TG.HapticFeedback.impactOccurred('medium');
                },
                closeModals() {
                    document.querySelectorAll('.modal-overlay').forEach(m => m.classList.remove('active'));
                }
            },

            // –°–ò–°–¢–ï–ú–ê –û–ü–õ–ê–¢–´ –ò API –ú–û–°–¢–ê
            Payment: {
                confirm() {
                    const body = document.getElementById('pay-body');
                    const actions = document.getElementById('pay-actions');
                    
                    actions.style.display = 'none';
                    body.innerHTML = `
                        <div style="text-align: center; padding: 20px;">
                            <div class="admin-log" id="status-console" style="height: 100px; text-align: left;">
                                > Connecting to Merchant API...
                            </div>
                            <p id="wait-text">–û–∂–∏–¥–∞–π—Ç–µ, –ø—Ä–æ–≤–µ—Ä—è–µ–º —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é...</p>
                        </div>
                    `;

                    this.simulateWorkflow();
                },

                simulateWorkflow() {
                    const logs = document.getElementById('status-console');
                    const steps = [
                        "> Check transaction: PENDING",
                        "> Searching for balance: OK",
                        "> Lolz Market Request: SENDED",
                        "> Validating account: OK",
                        "> Delivery process: INITIATED"
                    ];

                    let i = 0;
                    const interval = setInterval(() => {
                        if(i < steps.length) {
                            logs.innerHTML += `<br>${steps[i]}`;
                            logs.scrollTop = logs.scrollHeight;
                            TG.HapticFeedback.selectionChanged();
                            i++;
                        } else {
                            clearInterval(interval);
                            this.finalize();
                        }
                    }, 1200);
                },

                finalize() {
                    const creds = "LOG:" + Math.random().toString(36).substr(2, 8) + ":PASS:" + Math.random().toString(36).substr(2, 5);
                    const order = {
                        id: Math.floor(Math.random() * 99999),
                        name: Engine.State.selectedProduct.name,
                        price: Engine.State.selectedProduct.price,
                        creds: creds,
                        date: new Date().toLocaleDateString()
                    };

                    Engine.State.history.push(order);
                    localStorage.setItem('zik_orders', JSON.stringify(Engine.State.history));
                    
                    TG.HapticFeedback.notificationOccurred('success');
                    document.getElementById('pay-body').innerHTML = `
                        <div style="text-align: center; color: var(--accent-green);">
                            <h3>–£–°–ü–ï–®–ù–û!</h3>
                            <p style="color: #fff; margin: 10px 0;">–î–∞–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä–∞:</p>
                            <div style="background: #000; padding: 15px; border-radius: 10px; font-family: monospace;">${creds}</div>
                        </div>
                    `;
                    Engine.UI.updateProfile();
                    
                    setTimeout(() => {
                        TG.showConfirm("–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞?", (ok) => {
                            if(ok) {
                                navigator.clipboard.writeText(creds);
                                TG.showAlert("–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!");
                            }
                            Engine.UI.closeModals();
                        });
                    }, 1000);
                }
            },

            // –ò–°–¢–û–†–ò–Ø
            History: {
                show() {
                    if(Engine.State.history.length === 0) {
                        TG.showAlert("–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –∑–∞–∫–∞–∑–æ–≤");
                        return;
                    }
                    let res = "–í–ê–®–ò –ü–û–ö–£–ü–ö–ò:\n\n";
                    Engine.State.history.forEach(o => {
                        res += `üì¶ ${o.name}\nüí∞ ${o.price} ‚ÇΩ | üìÖ ${o.date}\nüîë ${o.creds}\n\n`;
                    });
                    TG.showAlert(res);
                }
            },

            // –ê–î–ú–ò–ù–ö–ê
            Admin: {
                log(msg) {
                    const l = document.getElementById('admin-log-stream');
                    l.innerHTML += `<br>> ${msg}`;
                    l.scrollTop = l.scrollHeight;
                },
                configurePrices() {
                    const newPrice = prompt("–í–≤–µ–¥–∏—Ç–µ –º–∞—Ä–∂—É –¥–ª—è Telegram (%)", "20");
                    if(newPrice) {
                        this.log(`Global margin set to ${newPrice}%`);
                        this.log("Syncing with Lolz Market API...");
                        TG.showAlert("–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ–±–Ω–æ–≤–ª–µ–Ω—ã —É–¥–∞–ª–µ–Ω–Ω–æ");
                    }
                }
            }
        };

        // –ó–ê–ü–£–°–ö –ü–†–ò–õ–û–ñ–ï–ù–ò–Ø
        document.addEventListener('DOMContentLoaded', () => {
            Engine.UI.init();
            Engine.Admin.log("App mounted successfully");
            Engine.Admin.log("Current user: " + Engine.State.user.first_name);
        });

    </script>
</body>
</html>

