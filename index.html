<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Zikrov Shop</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root {
            --bg: var(--tg-theme-bg-color, #ffffff);
            --text: var(--tg-theme-text-color, #000000);
            --hint: var(--tg-theme-hint-color, #999999);
            --button: var(--tg-theme-button-color, #3390ec);
            --button-text: var(--tg-theme-button-text-color, #ffffff);
            --secondary: var(--tg-theme-secondary-bg-color, #f4f4f5);
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: var(--bg);
            color: var(--text);
            margin: 0; padding: 0;
            padding-bottom: 80px;
        }

        /* –ù–∞–≤–∏–≥–∞—Ü–∏—è (–ù–∏–∂–Ω—è—è) */
        .tab-bar {
            display: flex;
            position: fixed;
            bottom: 0;
            width: 100%;
            background: var(--secondary);
            border-top: 1px solid rgba(0,0,0,0.1);
            z-index: 1000;
        }
        .tab-item {
            flex: 1;
            padding: 15px 0;
            text-align: center;
            font-size: 12px;
            font-weight: bold;
            color: var(--hint);
            cursor: pointer;
        }
        .tab-item.active { color: var(--button); }

        /* –°—Ç—Ä–∞–Ω–∏—Ü—ã */
        .page { display: none; padding: 15px; }
        .page.active { display: block; }

        /* –ü—Ä–æ—Ñ–∏–ª—å */
        .profile-header {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            background: var(--secondary);
            border-radius: 20px;
            margin-bottom: 20px;
        }
        .user-photo {
            width: 80px; height: 80px;
            border-radius: 50%;
            background: var(--button);
            margin-bottom: 10px;
            display: flex; align-items: center; justify-content: center;
            font-size: 30px; color: white; border: 3px solid var(--bg);
        }
        .username { font-size: 20px; font-weight: bold; }

        /* –ö–Ω–æ–ø–∫–∏ –≤ –ø—Ä–æ—Ñ–∏–ª–µ */
        .action-btn {
            width: 100%;
            background: var(--button);
            color: var(--button-text);
            border: none;
            padding: 15px;
            border-radius: 12px;
            font-weight: bold;
            margin-top: 10px;
        }

        /* –¢–æ–≤–∞—Ä—ã */
        .product-card {
            background: var(--secondary);
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .price { color: var(--button); font-weight: bold; }

        /* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∏—Å—Ç–æ—Ä–∏–∏ */
        #history-modal {
            display: none;
            position: fixed;
            top: 10%; left: 5%;
            width: 90%; height: 70%;
            background: var(--bg);
            border: 1px solid var(--hint);
            border-radius: 15px;
            z-index: 2000;
            padding: 20px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.3);
        }
    </style>
</head>
<body>

<div id="shop-page" class="page active">
    <div id="accs-list"></div>
</div>

<div id="profile-page" class="page">
    <div class="profile-header">
        <div id="user-pic" class="user-photo">?</div>
        <div id="user-full-name" class="username">User</div>
        <div id="user-tag" style="color: var(--hint);">@username</div>
    </div>
    
    <button class="action-btn" onclick="toggleHistory()">üì¶ –ú–æ–∏ –ø–æ–∫—É–ø–∫–∏</button>
</div>

<div class="tab-bar">
    <div class="tab-item active" onclick="switchTab('shop-page', this)">üõç –ú–∞–≥–∞–∑–∏–Ω</div>
    <div class="tab-item" onclick="switchTab('profile-page', this)">üë§ –ü—Ä–æ—Ñ–∏–ª—å</div>
</div>

<div id="history-modal">
    <h3>–ò—Å—Ç–æ—Ä–∏—è –∑–∞–∫–∞–∑–æ–≤</h3>
    <div id="history-content" style="font-size: 14px; overflow-y: auto; height: 80%;">–ü—É—Å—Ç–æ</div>
    <button class="action-btn" onclick="toggleHistory()" style="background: var(--hint);">–ó–∞–∫—Ä—ã—Ç—å</button>
</div>

<script>
    const tg = window.Telegram.WebApp;
    tg.expand();

    // –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    const user = tg.initDataUnsafe?.user;
    if (user) {
        document.getElementById('user-full-name').innerText = user.first_name + (user.last_name ? ' ' + user.last_name : '');
        document.getElementById('user-tag').innerText = user.username ? '@' + user.username : 'ID: ' + user.id;
        document.getElementById('user-pic').innerText = user.first_name.charAt(0);
        // –ï—Å–ª–∏ —É —é–∑–µ—Ä–∞ –µ—Å—Ç—å —Ñ–æ—Ç–æ, –≤ —Ä–µ–∞–ª—å–Ω–æ–º –±–æ—Ç–µ –æ–Ω–æ –ø–æ–¥–≥—Ä—É–∂–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ Bot API, 
        // –∑–¥–µ—Å—å –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –∏–Ω–∏—Ü–∏–∞–ª –∫–∞–∫ –≤ Telegram –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é.
    }

    const accsProducts = [
        { name: "–ì–µ—Ä–º–∞–Ω–∏—è +49", price: 300 },
        { name: "–ö–∞–∑–∞—Ö—Å—Ç–∞–Ω +7", price: 230 },
        { name: "–ë—Ä–∞–∑–∏–ª–∏—è +55", price: 100 },
        { name: "–¢—É—Ä—Ü–∏—è +90", price: 160 },
        { name: "–í—å–µ—Ç–Ω–∞–º +84", price: 80 },
        { name: "–ö–æ–ª—É–º–±–∏—è +57", price: 140 },
        { name: "–ú–µ–∫—Å–∏–∫–∞ +52", price: 140 },
        { name: "–¢–∞–π–ª–∞–Ω–¥ +66", price: 190 },
        { name: "–ö–∞–Ω–∞–¥–∞ +1", price: 70 },
        { name: "–ë–∞–Ω–≥–ª–∞–¥–µ—à +880", price: 90 },
        { name: "–£–∫—Ä–∞–∏–Ω–∞ +380", price: 230 },
        { name: "–ò–Ω–¥–∏—è +91", price: 60 },
        { name: "–°–®–ê +1", price: 60 }
    ];

    let cart = [];

    function switchTab(pageId, el) {
        document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
        document.querySelectorAll('.tab-item').forEach(t => t.classList.remove('active'));
        document.getElementById(pageId).classList.add('active');
        el.classList.add('active');
    }

    function render() {
        const list = document.getElementById('accs-list');
        list.innerHTML = accsProducts.map((p, i) => `
            <div class="product-card">
                <div><b>${p.name}</b><br><span class="price">${p.price} ‚ÇΩ</span></div>
                <button class="action-btn" style="width: auto; margin:0;" onclick="buy(${i})">–ö—É–ø–∏—Ç—å</button>
            </div>
        `).join('');
    }

    function buy(index) {
        const p = accsProducts[index];
        cart = [p]; // –í –¥–∞–Ω–Ω–æ–º –ø—Ä–∏–º–µ—Ä–µ –æ–¥–∏–Ω —Ç–æ–≤–∞—Ä –∑–∞ —Ä–∞–∑
        
        tg.showConfirm(`–û–ø–ª–∞—Ç–∏—Ç—å ${p.name} –∑–∞ ${p.price} ‚ÇΩ?`, (ok) => {
            if (ok) {
                // –ò–ù–°–¢–†–£–ö–¶–ò–Ø –û–ü–õ–ê–¢–´
                tg.showAlert(`‚úÖ –ò–ù–°–¢–†–£–ö–¶–ò–Ø –û–ü–õ–ê–¢–´:\n1. –ü–µ—Ä–µ–≤–µ–¥–∏—Ç–µ ${p.price}‚ÇΩ –Ω–∞ –∫–∞—Ä—Ç—É/–∫—Ä–∏–ø—Ç—É (—É—Ç–æ—á–Ω–∏—Ç–µ —É @zikrov).\n2. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "–û—Ç–ø—Ä–∞–≤–∏—Ç—å –æ—Ç—á–µ—Ç" –≤ –±–æ—Ç–µ.\n3. –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –¥–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã –∞–¥–º–∏–Ω—É.`);
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –∏—Å—Ç–æ—Ä–∏—é
                let history = JSON.parse(localStorage.getItem('my_orders') || '[]');
                history.push(`${new Date().toLocaleDateString()} - ${p.name}`);
                localStorage.setItem('my_orders', JSON.stringify(history));

                // –û—Ç–ø—Ä–∞–≤–∫–∞ –æ—Ç—á–µ—Ç–∞ –≤–∞–º –≤ –±–æ—Ç
                const report = `üìÑ –û–¢–ß–ï–¢ –û –ó–ê–ö–ê–ó–ï\nüë§ –Æ–∑–µ—Ä: @${user?.username || '—Å–∫—Ä—ã—Ç'}\nüì¶ –¢–æ–≤–∞—Ä: ${p.name}\nüí∞ –¶–µ–Ω–∞: ${p.price} ‚ÇΩ\nüìù –°—Ç–∞—Ç—É—Å: –û–∂–∏–¥–∞–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –æ–ø–ª–∞—Ç—ã`;
                tg.sendData(report);
            }
        });
    }

    function toggleHistory() {
        const modal = document.getElementById('history-modal');
        const content = document.getElementById('history-content');
        const history = JSON.parse(localStorage.getItem('my_orders') || '[]');
        
        content.innerHTML = history.length > 0 ? history.map(h => `‚Ä¢ ${h}<br>`).join('') : "–ü–æ–∫—É–ø–æ–∫ –µ—â–µ –Ω–µ—Ç";
        modal.style.display = modal.style.display === 'block' ? 'none' : 'block';
    }

    render();
</script>
</body>
</html>
